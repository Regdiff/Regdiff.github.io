<!DOCTYPE html><html><head><meta name="author" content="Circle 阅读助手" /><meta name="description" content="由 [Circle 阅读助手](https://circlereader.com) 生成" /><link rel="shortcut icon" type="image/x-icon" href="https://static.zhihu.com/heifetz/favicon.ico"  /><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><style>html,body{padding:0;margin:0;}.card{min-height:100vh;}.container .ant-app{padding-right: 0 !important;}
.anticon {
  display: inline-flex;
  alignItems: center;
  color: inherit;
  font-style: normal;
  line-height: 0;
  text-align: center;
  text-transform: none;
  vertical-align: -0.125em;
  text-rendering: optimizeLegibility;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

.anticon > * {
  line-height: 1;
}

.anticon svg {
  display: inline-block;
}

.anticon::before {
  display: none;
}

.anticon .anticon-icon {
  display: block;
}

.anticon[tabindex] {
  cursor: pointer;
}

.anticon-spin::before,
.anticon-spin {
  display: inline-block;
  -webkit-animation: loadingCircle 1s infinite linear;
  animation: loadingCircle 1s infinite linear;
}

@-webkit-keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}

@keyframes loadingCircle {
  100% {
    -webkit-transform: rotate(360deg);
    transform: rotate(360deg);
  }
}
.css-16cpc8y a{color:#416ed2;text-decoration:none;background-color:transparent;outline:none;cursor:pointer;transition:color 0.3s;-webkit-text-decoration-skip:objects;}.css-16cpc8y a:hover{color:#305ab7;}.css-16cpc8y a:active{color:#305ab7;}.css-16cpc8y a:active,.css-16cpc8y a:hover{text-decoration:none;outline:0;}.css-16cpc8y a:focus{text-decoration:none;outline:0;}.css-16cpc8y a[disabled]{color:rgba(0, 0, 0, 0.25);cursor:not-allowed;}.css-16cpc8y[class^="ant-avatar"],.css-16cpc8y[class*=" ant-avatar"]{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';font-size:14px;box-sizing:border-box;}.css-16cpc8y[class^="ant-avatar"]::before,.css-16cpc8y[class*=" ant-avatar"]::before,.css-16cpc8y[class^="ant-avatar"]::after,.css-16cpc8y[class*=" ant-avatar"]::after{box-sizing:border-box;}.css-16cpc8y[class^="ant-avatar"] [class^="ant-avatar"],.css-16cpc8y[class*=" ant-avatar"] [class^="ant-avatar"],.css-16cpc8y[class^="ant-avatar"] [class*=" ant-avatar"],.css-16cpc8y[class*=" ant-avatar"] [class*=" ant-avatar"]{box-sizing:border-box;}.css-16cpc8y[class^="ant-avatar"] [class^="ant-avatar"]::before,.css-16cpc8y[class*=" ant-avatar"] [class^="ant-avatar"]::before,.css-16cpc8y[class^="ant-avatar"] [class*=" ant-avatar"]::before,.css-16cpc8y[class*=" ant-avatar"] [class*=" ant-avatar"]::before,.css-16cpc8y[class^="ant-avatar"] [class^="ant-avatar"]::after,.css-16cpc8y[class*=" ant-avatar"] [class^="ant-avatar"]::after,.css-16cpc8y[class^="ant-avatar"] [class*=" ant-avatar"]::after,.css-16cpc8y[class*=" ant-avatar"] [class*=" ant-avatar"]::after{box-sizing:border-box;}.css-16cpc8y.ant-avatar{box-sizing:border-box;margin:0;padding:0;color:#fff;font-size:14px;line-height:1.5714285714285714;list-style:none;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';position:relative;display:inline-flex;justify-content:center;align-items:center;overflow:hidden;white-space:nowrap;text-align:center;vertical-align:middle;background:rgb(127,127,127);border:1px solid transparent;width:32px;height:32px;border-radius:50%;}.css-16cpc8y.ant-avatar-image{background:transparent;}.css-16cpc8y.ant-avatar .ant-image-img{display:block;}.css-16cpc8y.ant-avatar.ant-avatar-square{border-radius:6px;}.css-16cpc8y.ant-avatar.ant-avatar-icon{font-size:18px;}.css-16cpc8y.ant-avatar.ant-avatar-icon >.anticon{margin:0;}.css-16cpc8y.ant-avatar-lg{width:40px;height:40px;border-radius:50%;}.css-16cpc8y.ant-avatar-lg.ant-avatar-square{border-radius:8px;}.css-16cpc8y.ant-avatar-lg.ant-avatar-icon{font-size:24px;}.css-16cpc8y.ant-avatar-lg.ant-avatar-icon >.anticon{margin:0;}.css-16cpc8y.ant-avatar-sm{width:24px;height:24px;border-radius:50%;}.css-16cpc8y.ant-avatar-sm.ant-avatar-square{border-radius:4px;}.css-16cpc8y.ant-avatar-sm.ant-avatar-icon{font-size:14px;}.css-16cpc8y.ant-avatar-sm.ant-avatar-icon >.anticon{margin:0;}.css-16cpc8y.ant-avatar >img{display:block;width:100%;height:100%;object-fit:cover;}.css-16cpc8y.ant-avatar-group{display:inline-flex;}.css-16cpc8y.ant-avatar-group .ant-avatar{border-color:#ffffff;}.css-16cpc8y.ant-avatar-group >*:not(:first-child){margin-left:-8px;}.css-16cpc8y.ant-avatar-group-popover .ant-avatar+.ant-avatar{margin-left:4px;}.css-16cpc8y.ant-wave{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';font-size:14px;box-sizing:border-box;}.css-16cpc8y.ant-wave::before,.css-16cpc8y.ant-wave::after{box-sizing:border-box;}.css-16cpc8y.ant-wave [class^="ant-wave"],.css-16cpc8y.ant-wave [class*=" ant-wave"]{box-sizing:border-box;}.css-16cpc8y.ant-wave [class^="ant-wave"]::before,.css-16cpc8y.ant-wave [class*=" ant-wave"]::before,.css-16cpc8y.ant-wave [class^="ant-wave"]::after,.css-16cpc8y.ant-wave [class*=" ant-wave"]::after{box-sizing:border-box;}.css-16cpc8y.ant-wave{position:absolute;background:transparent;pointer-events:none;box-sizing:border-box;color:var(--wave-color, #416ed2);box-shadow:0 0 0 0 currentcolor;opacity:0.2;}.css-16cpc8y.ant-wave.wave-motion-appear{transition:box-shadow 0.4s cubic-bezier(0.08, 0.82, 0.17, 1),opacity 2s cubic-bezier(0.08, 0.82, 0.17, 1);}.css-16cpc8y.ant-wave.wave-motion-appear-active{box-shadow:0 0 0 6px currentcolor;opacity:0;}.css-16cpc8y.ant-wave.wave-motion-appear.wave-quick{transition:box-shadow 0.3s cubic-bezier(0.645, 0.045, 0.355, 1),opacity 0.35s cubic-bezier(0.645, 0.045, 0.355, 1);}.css-16cpc8y.ant-tag{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';font-size:14px;box-sizing:border-box;}.css-16cpc8y.ant-tag::before,.css-16cpc8y.ant-tag::after{box-sizing:border-box;}.css-16cpc8y.ant-tag [class^="ant-tag"],.css-16cpc8y.ant-tag [class*=" ant-tag"]{box-sizing:border-box;}.css-16cpc8y.ant-tag [class^="ant-tag"]::before,.css-16cpc8y.ant-tag [class*=" ant-tag"]::before,.css-16cpc8y.ant-tag [class^="ant-tag"]::after,.css-16cpc8y.ant-tag [class*=" ant-tag"]::after{box-sizing:border-box;}.css-16cpc8y.ant-tag{box-sizing:border-box;margin:0;padding:0;color:#1b1b1b;font-size:12px;line-height:20px;list-style:none;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';display:inline-block;height:auto;margin-right:8px;padding-left:7px;padding-right:7px;white-space:nowrap;background:#fafafa;border:1px solid rgba(237,237,237, 0.6);border-radius:4px;opacity:1;transition:all 0.2s;text-align:start;position:relative;}.css-16cpc8y.ant-tag.ant-tag-rtl{direction:rtl;}.css-16cpc8y.ant-tag,.css-16cpc8y.ant-tag a,.css-16cpc8y.ant-tag a:hover{color:#1b1b1b;}.css-16cpc8y.ant-tag .ant-tag-close-icon{margin-left:3px;font-size:10px;color:rgb(57,57,57);cursor:pointer;transition:all 0.2s;}.css-16cpc8y.ant-tag .ant-tag-close-icon:hover{color:#1b1b1b;}.css-16cpc8y.ant-tag.ant-tag-has-color{border-color:transparent;}.css-16cpc8y.ant-tag.ant-tag-has-color,.css-16cpc8y.ant-tag.ant-tag-has-color a,.css-16cpc8y.ant-tag.ant-tag-has-color a:hover,.css-16cpc8y.ant-tag.ant-tag-has-color .anticon-close,.css-16cpc8y.ant-tag.ant-tag-has-color .anticon-close:hover{color:#fff;}.css-16cpc8y.ant-tag-checkable{background-color:transparent;border-color:transparent;cursor:pointer;}.css-16cpc8y.ant-tag-checkable:not(.ant-tag-checkable-checked):hover{color:#416ed2;background-color:rgba(0, 0, 0, 0.06);}.css-16cpc8y.ant-tag-checkable:active,.css-16cpc8y.ant-tag-checkable-checked{color:#fff;}.css-16cpc8y.ant-tag-checkable-checked{background-color:#416ed2;}.css-16cpc8y.ant-tag-checkable-checked:hover{background-color:#6891de;}.css-16cpc8y.ant-tag-checkable:active{background-color:#2c50ab;}.css-16cpc8y.ant-tag-hidden{display:none;}.css-16cpc8y.ant-tag >.anticon+span,.css-16cpc8y.ant-tag >span+.anticon{margin-left:7px;}.css-16cpc8y.ant-tag-borderless{border-color:transparent;background:#fafafa;}.css-16cpc8y.ant-space{display:inline-flex;}.css-16cpc8y.ant-space-rtl{direction:rtl;}.css-16cpc8y.ant-space-vertical{flex-direction:column;}.css-16cpc8y.ant-space-align{flex-direction:column;}.css-16cpc8y.ant-space-align-center{align-items:center;}.css-16cpc8y.ant-space-align-start{align-items:flex-start;}.css-16cpc8y.ant-space-align-end{align-items:flex-end;}.css-16cpc8y.ant-space-align-baseline{align-items:baseline;}.css-16cpc8y.ant-space .ant-space-item:empty{display:none;}.css-16cpc8y.ant-space .ant-space-item>.ant-badge-not-a-wrapper:only-child{display:block;}.css-16cpc8y.ant-space-gap-row-small{row-gap:8px;}.css-16cpc8y.ant-space-gap-row-middle{row-gap:16px;}.css-16cpc8y.ant-space-gap-row-large{row-gap:24px;}.css-16cpc8y.ant-space-gap-col-small{column-gap:8px;}.css-16cpc8y.ant-space-gap-col-middle{column-gap:16px;}.css-16cpc8y.ant-space-gap-col-large{column-gap:24px;}.css-16cpc8y.ant-space-block{display:flex;width:100%;}.css-16cpc8y.ant-space-vertical{flex-direction:column;}.css-16cpc8y.ant-btn{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';font-size:14px;box-sizing:border-box;}.css-16cpc8y.ant-btn::before,.css-16cpc8y.ant-btn::after{box-sizing:border-box;}.css-16cpc8y.ant-btn [class^="ant-btn"],.css-16cpc8y.ant-btn [class*=" ant-btn"]{box-sizing:border-box;}.css-16cpc8y.ant-btn [class^="ant-btn"]::before,.css-16cpc8y.ant-btn [class*=" ant-btn"]::before,.css-16cpc8y.ant-btn [class^="ant-btn"]::after,.css-16cpc8y.ant-btn [class*=" ant-btn"]::after{box-sizing:border-box;}.css-16cpc8y.ant-btn{outline:none;position:relative;display:inline-block;font-weight:400;white-space:nowrap;text-align:center;background-image:none;background:transparent;border:1px solid transparent;cursor:pointer;transition:all 0.2s cubic-bezier(0.645, 0.045, 0.355, 1);user-select:none;touch-action:manipulation;color:#1b1b1b;}.css-16cpc8y.ant-btn:disabled>*{pointer-events:none;}.css-16cpc8y.ant-btn >span{display:inline-block;}.css-16cpc8y.ant-btn .ant-btn-icon{line-height:0;}.css-16cpc8y.ant-btn >.anticon+span,.css-16cpc8y.ant-btn >span+.anticon{margin-left:8px;}.css-16cpc8y.ant-btn:not(.ant-btn-icon-only)>.ant-btn-icon.ant-btn-loading-icon,.css-16cpc8y.ant-btn:not(.ant-btn-icon-only)>.ant-btn-icon:not(:last-child){margin-right:8px;}.css-16cpc8y.ant-btn >a{color:currentColor;}.css-16cpc8y.ant-btn:not(:disabled):focus-visible{outline:4px solid #c3d9f7;outline-offset:1px;transition:outline-offset 0s,outline 0s;}.css-16cpc8y.ant-btn.ant-btn-two-chinese-chars::first-letter{letter-spacing:0.34em;}.css-16cpc8y.ant-btn.ant-btn-two-chinese-chars>*:not(.anticon){margin-right:-0.34em;letter-spacing:0.34em;}.css-16cpc8y.ant-btn-icon-only.ant-btn-compact-item{flex:none;}.css-16cpc8y.ant-btn{font-size:14px;line-height:1.5714285714285714;height:32px;padding:4px 15px;border-radius:6px;}.css-16cpc8y.ant-btn.ant-btn-icon-only{width:32px;padding-left:0;padding-right:0;}.css-16cpc8y.ant-btn.ant-btn-icon-only.ant-btn-round{width:auto;}.css-16cpc8y.ant-btn.ant-btn-icon-only .anticon{font-size:16px;}.css-16cpc8y.ant-btn.ant-btn-loading{opacity:0.65;cursor:default;}.css-16cpc8y.ant-btn .ant-btn-loading-icon{transition:width 0.3s cubic-bezier(0.645, 0.045, 0.355, 1),opacity 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);}.css-16cpc8y.ant-btn.ant-btn-circle.ant-btn{min-width:32px;padding-left:0;padding-right:0;border-radius:50%;}.css-16cpc8y.ant-btn.ant-btn-round.ant-btn{border-radius:32px;padding-left:16px;padding-right:16px;}.css-16cpc8y.ant-btn-sm{font-size:14px;line-height:1.5714285714285714;height:24px;padding:0px 7px;border-radius:4px;}.css-16cpc8y.ant-btn-sm.ant-btn-icon-only{width:24px;padding-left:0;padding-right:0;}.css-16cpc8y.ant-btn-sm.ant-btn-icon-only.ant-btn-round{width:auto;}.css-16cpc8y.ant-btn-sm.ant-btn-icon-only .anticon{font-size:14px;}.css-16cpc8y.ant-btn-sm.ant-btn-loading{opacity:0.65;cursor:default;}.css-16cpc8y.ant-btn-sm .ant-btn-loading-icon{transition:width 0.3s cubic-bezier(0.645, 0.045, 0.355, 1),opacity 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);}.css-16cpc8y.ant-btn.ant-btn-circle.ant-btn-sm{min-width:24px;padding-left:0;padding-right:0;border-radius:50%;}.css-16cpc8y.ant-btn.ant-btn-round.ant-btn-sm{border-radius:24px;padding-left:12px;padding-right:12px;}.css-16cpc8y.ant-btn-lg{font-size:16px;line-height:1.5;height:40px;padding:7px 15px;border-radius:8px;}.css-16cpc8y.ant-btn-lg.ant-btn-icon-only{width:40px;padding-left:0;padding-right:0;}.css-16cpc8y.ant-btn-lg.ant-btn-icon-only.ant-btn-round{width:auto;}.css-16cpc8y.ant-btn-lg.ant-btn-icon-only .anticon{font-size:18px;}.css-16cpc8y.ant-btn-lg.ant-btn-loading{opacity:0.65;cursor:default;}.css-16cpc8y.ant-btn-lg .ant-btn-loading-icon{transition:width 0.3s cubic-bezier(0.645, 0.045, 0.355, 1),opacity 0.3s cubic-bezier(0.645, 0.045, 0.355, 1);}.css-16cpc8y.ant-btn.ant-btn-circle.ant-btn-lg{min-width:40px;padding-left:0;padding-right:0;border-radius:50%;}.css-16cpc8y.ant-btn.ant-btn-round.ant-btn-lg{border-radius:40px;padding-left:20px;padding-right:20px;}.css-16cpc8y.ant-btn.ant-btn-block{width:100%;}.css-16cpc8y.ant-btn-default{background:#ffffff;border-color:rgba(237,237,237, 0.6);color:#1b1b1b;box-shadow:0 2px 0 rgba(0, 0, 0, 0.02);}.css-16cpc8y.ant-btn-default:disabled,.css-16cpc8y.ant-btn-default.ant-btn-disabled{cursor:not-allowed;border-color:rgba(237,237,237, 0.6);color:rgba(0, 0, 0, 0.25);background:rgba(0, 0, 0, 0.04);box-shadow:none;}.css-16cpc8y.ant-btn-default:not(:disabled):not(.ant-btn-disabled):hover{color:#6891de;border-color:#6891de;background:#ffffff;}.css-16cpc8y.ant-btn-default:not(:disabled):not(.ant-btn-disabled):active{color:#2c50ab;border-color:#2c50ab;background:#ffffff;}.css-16cpc8y.ant-btn-default.ant-btn-background-ghost{color:#ffffff;background:transparent;border-color:#ffffff;box-shadow:none;}.css-16cpc8y.ant-btn-default.ant-btn-background-ghost:not(:disabled):not(.ant-btn-disabled):hover{background:transparent;}.css-16cpc8y.ant-btn-default.ant-btn-background-ghost:not(:disabled):not(.ant-btn-disabled):active{background:transparent;}.css-16cpc8y.ant-btn-default.ant-btn-background-ghost:disabled{cursor:not-allowed;color:rgba(0, 0, 0, 0.25);border-color:rgba(237,237,237, 0.6);}.css-16cpc8y.ant-btn-default.ant-btn-dangerous{color:#ff4d4f;border-color:#ff4d4f;}.css-16cpc8y.ant-btn-default.ant-btn-dangerous:not(:disabled):not(.ant-btn-disabled):hover{color:#ff7875;border-color:#ffa39e;}.css-16cpc8y.ant-btn-default.ant-btn-dangerous:not(:disabled):not(.ant-btn-disabled):active{color:#d9363e;border-color:#d9363e;}.css-16cpc8y.ant-btn-default.ant-btn-dangerous.ant-btn-background-ghost{color:#ff4d4f;background:transparent;border-color:#ff4d4f;box-shadow:none;}.css-16cpc8y.ant-btn-default.ant-btn-dangerous.ant-btn-background-ghost:not(:disabled):not(.ant-btn-disabled):hover{background:transparent;}.css-16cpc8y.ant-btn-default.ant-btn-dangerous.ant-btn-background-ghost:not(:disabled):not(.ant-btn-disabled):active{background:transparent;}.css-16cpc8y.ant-btn-default.ant-btn-dangerous.ant-btn-background-ghost:disabled{cursor:not-allowed;color:rgba(0, 0, 0, 0.25);border-color:rgba(237,237,237, 0.6);}.css-16cpc8y.ant-btn-default.ant-btn-dangerous:disabled,.css-16cpc8y.ant-btn-default.ant-btn-dangerous.ant-btn-disabled{cursor:not-allowed;border-color:rgba(237,237,237, 0.6);color:rgba(0, 0, 0, 0.25);background:rgba(0, 0, 0, 0.04);box-shadow:none;}.css-16cpc8y.ant-btn-primary{color:#fff;background:#416ed2;box-shadow:0 2px 0 rgba(5, 122, 255, 0.06);}.css-16cpc8y.ant-btn-primary:disabled,.css-16cpc8y.ant-btn-primary.ant-btn-disabled{cursor:not-allowed;border-color:rgba(237,237,237, 0.6);color:rgba(0, 0, 0, 0.25);background:rgba(0, 0, 0, 0.04);box-shadow:none;}.css-16cpc8y.ant-btn-primary:not(:disabled):not(.ant-btn-disabled):hover{color:#fff;background:#6891de;}.css-16cpc8y.ant-btn-primary:not(:disabled):not(.ant-btn-disabled):active{color:#fff;background:#2c50ab;}.css-16cpc8y.ant-btn-primary.ant-btn-background-ghost{color:#416ed2;background:transparent;border-color:#416ed2;box-shadow:none;}.css-16cpc8y.ant-btn-primary.ant-btn-background-ghost:not(:disabled):not(.ant-btn-disabled):hover{background:transparent;color:#6891de;border-color:#6891de;}.css-16cpc8y.ant-btn-primary.ant-btn-background-ghost:not(:disabled):not(.ant-btn-disabled):active{background:transparent;color:#2c50ab;border-color:#2c50ab;}.css-16cpc8y.ant-btn-primary.ant-btn-background-ghost:disabled{cursor:not-allowed;color:rgba(0, 0, 0, 0.25);border-color:rgba(237,237,237, 0.6);}.css-16cpc8y.ant-btn-primary.ant-btn-dangerous{background:#ff4d4f;box-shadow:0 2px 0 rgba(255, 38, 5, 0.06);color:#fff;}.css-16cpc8y.ant-btn-primary.ant-btn-dangerous:not(:disabled):not(.ant-btn-disabled):hover{background:#ff7875;}.css-16cpc8y.ant-btn-primary.ant-btn-dangerous:not(:disabled):not(.ant-btn-disabled):active{background:#d9363e;}.css-16cpc8y.ant-btn-primary.ant-btn-dangerous.ant-btn-background-ghost{color:#ff4d4f;background:transparent;border-color:#ff4d4f;box-shadow:none;}.css-16cpc8y.ant-btn-primary.ant-btn-dangerous.ant-btn-background-ghost:not(:disabled):not(.ant-btn-disabled):hover{background:transparent;color:#ff7875;border-color:#ff7875;}.css-16cpc8y.ant-btn-primary.ant-btn-dangerous.ant-btn-background-ghost:not(:disabled):not(.ant-btn-disabled):active{background:transparent;color:#d9363e;border-color:#d9363e;}.css-16cpc8y.ant-btn-primary.ant-btn-dangerous.ant-btn-background-ghost:disabled{cursor:not-allowed;color:rgba(0, 0, 0, 0.25);border-color:rgba(237,237,237, 0.6);}.css-16cpc8y.ant-btn-primary.ant-btn-dangerous:disabled,.css-16cpc8y.ant-btn-primary.ant-btn-dangerous.ant-btn-disabled{cursor:not-allowed;border-color:rgba(237,237,237, 0.6);color:rgba(0, 0, 0, 0.25);background:rgba(0, 0, 0, 0.04);box-shadow:none;}.css-16cpc8y.ant-btn-dashed{background:#ffffff;border-color:rgba(237,237,237, 0.6);color:#1b1b1b;box-shadow:0 2px 0 rgba(0, 0, 0, 0.02);border-style:dashed;}.css-16cpc8y.ant-btn-dashed:disabled,.css-16cpc8y.ant-btn-dashed.ant-btn-disabled{cursor:not-allowed;border-color:rgba(237,237,237, 0.6);color:rgba(0, 0, 0, 0.25);background:rgba(0, 0, 0, 0.04);box-shadow:none;}.css-16cpc8y.ant-btn-dashed:not(:disabled):not(.ant-btn-disabled):hover{color:#6891de;border-color:#6891de;background:#ffffff;}.css-16cpc8y.ant-btn-dashed:not(:disabled):not(.ant-btn-disabled):active{color:#2c50ab;border-color:#2c50ab;background:#ffffff;}.css-16cpc8y.ant-btn-dashed.ant-btn-background-ghost{color:#ffffff;background:transparent;border-color:#ffffff;box-shadow:none;}.css-16cpc8y.ant-btn-dashed.ant-btn-background-ghost:not(:disabled):not(.ant-btn-disabled):hover{background:transparent;}.css-16cpc8y.ant-btn-dashed.ant-btn-background-ghost:not(:disabled):not(.ant-btn-disabled):active{background:transparent;}.css-16cpc8y.ant-btn-dashed.ant-btn-background-ghost:disabled{cursor:not-allowed;color:rgba(0, 0, 0, 0.25);border-color:rgba(237,237,237, 0.6);}.css-16cpc8y.ant-btn-dashed.ant-btn-dangerous{color:#ff4d4f;border-color:#ff4d4f;}.css-16cpc8y.ant-btn-dashed.ant-btn-dangerous:not(:disabled):not(.ant-btn-disabled):hover{color:#ff7875;border-color:#ffa39e;}.css-16cpc8y.ant-btn-dashed.ant-btn-dangerous:not(:disabled):not(.ant-btn-disabled):active{color:#d9363e;border-color:#d9363e;}.css-16cpc8y.ant-btn-dashed.ant-btn-dangerous.ant-btn-background-ghost{color:#ff4d4f;background:transparent;border-color:#ff4d4f;box-shadow:none;}.css-16cpc8y.ant-btn-dashed.ant-btn-dangerous.ant-btn-background-ghost:not(:disabled):not(.ant-btn-disabled):hover{background:transparent;}.css-16cpc8y.ant-btn-dashed.ant-btn-dangerous.ant-btn-background-ghost:not(:disabled):not(.ant-btn-disabled):active{background:transparent;}.css-16cpc8y.ant-btn-dashed.ant-btn-dangerous.ant-btn-background-ghost:disabled{cursor:not-allowed;color:rgba(0, 0, 0, 0.25);border-color:rgba(237,237,237, 0.6);}.css-16cpc8y.ant-btn-dashed.ant-btn-dangerous:disabled,.css-16cpc8y.ant-btn-dashed.ant-btn-dangerous.ant-btn-disabled{cursor:not-allowed;border-color:rgba(237,237,237, 0.6);color:rgba(0, 0, 0, 0.25);background:rgba(0, 0, 0, 0.04);box-shadow:none;}.css-16cpc8y.ant-btn-link{color:#416ed2;}.css-16cpc8y.ant-btn-link:not(:disabled):not(.ant-btn-disabled):hover{color:#305ab7;background:transparent;}.css-16cpc8y.ant-btn-link:not(:disabled):not(.ant-btn-disabled):active{color:#305ab7;}.css-16cpc8y.ant-btn-link:disabled,.css-16cpc8y.ant-btn-link.ant-btn-disabled{cursor:not-allowed;color:rgba(0, 0, 0, 0.25);}.css-16cpc8y.ant-btn-link.ant-btn-dangerous{color:#ff4d4f;}.css-16cpc8y.ant-btn-link.ant-btn-dangerous:not(:disabled):not(.ant-btn-disabled):hover{color:#ff7875;}.css-16cpc8y.ant-btn-link.ant-btn-dangerous:not(:disabled):not(.ant-btn-disabled):active{color:#d9363e;}.css-16cpc8y.ant-btn-link.ant-btn-dangerous:disabled,.css-16cpc8y.ant-btn-link.ant-btn-dangerous.ant-btn-disabled{cursor:not-allowed;color:rgba(0, 0, 0, 0.25);}.css-16cpc8y.ant-btn-text:not(:disabled):not(.ant-btn-disabled):hover{color:#1b1b1b;background:rgba(0, 0, 0, 0.06);}.css-16cpc8y.ant-btn-text:not(:disabled):not(.ant-btn-disabled):active{color:#1b1b1b;background:rgba(0, 0, 0, 0.15);}.css-16cpc8y.ant-btn-text:disabled,.css-16cpc8y.ant-btn-text.ant-btn-disabled{cursor:not-allowed;color:rgba(0, 0, 0, 0.25);}.css-16cpc8y.ant-btn-text.ant-btn-dangerous{color:#ff4d4f;}.css-16cpc8y.ant-btn-text.ant-btn-dangerous:disabled,.css-16cpc8y.ant-btn-text.ant-btn-dangerous.ant-btn-disabled{cursor:not-allowed;color:rgba(0, 0, 0, 0.25);}.css-16cpc8y.ant-btn-text.ant-btn-dangerous:not(:disabled):not(.ant-btn-disabled):hover{color:#ff7875;background:#fff2f0;}.css-16cpc8y.ant-btn-text.ant-btn-dangerous:not(:disabled):not(.ant-btn-disabled):active{color:#ff7875;background:#fff2f0;}.css-16cpc8y.ant-btn-ghost.ant-btn-background-ghost{color:#ffffff;background:transparent;border-color:#ffffff;box-shadow:none;}.css-16cpc8y.ant-btn-ghost.ant-btn-background-ghost:not(:disabled):not(.ant-btn-disabled):hover{background:transparent;}.css-16cpc8y.ant-btn-ghost.ant-btn-background-ghost:not(:disabled):not(.ant-btn-disabled):active{background:transparent;}.css-16cpc8y.ant-btn-ghost.ant-btn-background-ghost:disabled{cursor:not-allowed;color:rgba(0, 0, 0, 0.25);border-color:rgba(237,237,237, 0.6);}.css-16cpc8y.ant-btn-group{position:relative;display:inline-flex;}.css-16cpc8y.ant-btn-group >span:not(:last-child),.css-16cpc8y.ant-btn-group >.ant-btn:not(:last-child),.css-16cpc8y.ant-btn-group >span:not(:last-child)>.ant-btn,.css-16cpc8y.ant-btn-group >.ant-btn:not(:last-child)>.ant-btn{border-top-right-radius:0;border-bottom-right-radius:0;}.css-16cpc8y.ant-btn-group >span:not(:first-child),.css-16cpc8y.ant-btn-group >.ant-btn:not(:first-child){margin-left:-1px;}.css-16cpc8y.ant-btn-group >span:not(:first-child),.css-16cpc8y.ant-btn-group >.ant-btn:not(:first-child),.css-16cpc8y.ant-btn-group >span:not(:first-child)>.ant-btn,.css-16cpc8y.ant-btn-group >.ant-btn:not(:first-child)>.ant-btn{border-top-left-radius:0;border-bottom-left-radius:0;}.css-16cpc8y.ant-btn-group .ant-btn{position:relative;z-index:1;}.css-16cpc8y.ant-btn-group .ant-btn:hover,.css-16cpc8y.ant-btn-group .ant-btn:focus,.css-16cpc8y.ant-btn-group .ant-btn:active{z-index:2;}.css-16cpc8y.ant-btn-group .ant-btn[disabled]{z-index:0;}.css-16cpc8y.ant-btn-group .ant-btn-icon-only{font-size:14px;}.css-16cpc8y.ant-btn-group >span:not(:last-child):not(:disabled),.css-16cpc8y.ant-btn-group >.ant-btn-primary:not(:last-child):not(:disabled),.css-16cpc8y.ant-btn-group >span:not(:last-child)>.ant-btn-primary:not(:disabled),.css-16cpc8y.ant-btn-group >.ant-btn-primary:not(:last-child)>.ant-btn-primary:not(:disabled){border-right-color:#6891de;}.css-16cpc8y.ant-btn-group >span:not(:first-child):not(:disabled),.css-16cpc8y.ant-btn-group >.ant-btn-primary:not(:first-child):not(:disabled),.css-16cpc8y.ant-btn-group >span:not(:first-child)>.ant-btn-primary:not(:disabled),.css-16cpc8y.ant-btn-group >.ant-btn-primary:not(:first-child)>.ant-btn-primary:not(:disabled){border-left-color:#6891de;}.css-16cpc8y.ant-btn-group >span:not(:last-child):not(:disabled),.css-16cpc8y.ant-btn-group >.ant-btn-danger:not(:last-child):not(:disabled),.css-16cpc8y.ant-btn-group >span:not(:last-child)>.ant-btn-danger:not(:disabled),.css-16cpc8y.ant-btn-group >.ant-btn-danger:not(:last-child)>.ant-btn-danger:not(:disabled){border-right-color:#ff7875;}.css-16cpc8y.ant-btn-group >span:not(:first-child):not(:disabled),.css-16cpc8y.ant-btn-group >.ant-btn-danger:not(:first-child):not(:disabled),.css-16cpc8y.ant-btn-group >span:not(:first-child)>.ant-btn-danger:not(:disabled),.css-16cpc8y.ant-btn-group >.ant-btn-danger:not(:first-child)>.ant-btn-danger:not(:disabled){border-left-color:#ff7875;}.css-16cpc8y[class^="ant-modal"],.css-16cpc8y[class*=" ant-modal"]{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';font-size:14px;box-sizing:border-box;}.css-16cpc8y[class^="ant-modal"]::before,.css-16cpc8y[class*=" ant-modal"]::before,.css-16cpc8y[class^="ant-modal"]::after,.css-16cpc8y[class*=" ant-modal"]::after{box-sizing:border-box;}.css-16cpc8y[class^="ant-modal"] [class^="ant-modal"],.css-16cpc8y[class*=" ant-modal"] [class^="ant-modal"],.css-16cpc8y[class^="ant-modal"] [class*=" ant-modal"],.css-16cpc8y[class*=" ant-modal"] [class*=" ant-modal"]{box-sizing:border-box;}.css-16cpc8y[class^="ant-modal"] [class^="ant-modal"]::before,.css-16cpc8y[class*=" ant-modal"] [class^="ant-modal"]::before,.css-16cpc8y[class^="ant-modal"] [class*=" ant-modal"]::before,.css-16cpc8y[class*=" ant-modal"] [class*=" ant-modal"]::before,.css-16cpc8y[class^="ant-modal"] [class^="ant-modal"]::after,.css-16cpc8y[class*=" ant-modal"] [class^="ant-modal"]::after,.css-16cpc8y[class^="ant-modal"] [class*=" ant-modal"]::after,.css-16cpc8y[class*=" ant-modal"] [class*=" ant-modal"]::after{box-sizing:border-box;}.css-16cpc8y.ant-modal-root .ant-modal-wrap-rtl{direction:rtl;}.css-16cpc8y.ant-modal-root .ant-modal-centered{text-align:center;}.css-16cpc8y.ant-modal-root .ant-modal-centered::before{display:inline-block;width:0;height:100%;vertical-align:middle;content:"";}.css-16cpc8y.ant-modal-root .ant-modal-centered .ant-modal{top:0;display:inline-block;padding-bottom:0;text-align:start;vertical-align:middle;}@media (max-width: 767px){.css-16cpc8y.ant-modal-root .ant-modal{max-width:calc(100vw - 16px);margin:8px auto;}.css-16cpc8y.ant-modal-root .ant-modal-centered .ant-modal{flex:1;}}.css-16cpc8y.ant-modal{box-sizing:border-box;margin:0 auto;padding:0;color:#1b1b1b;font-size:14px;line-height:1.5714285714285714;list-style:none;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';pointer-events:none;position:relative;top:100px;width:auto;max-width:calc(100vw - 32px);padding-bottom:24px;}.css-16cpc8y.ant-modal .ant-modal-title{margin:0;color:#1b1b1b;font-weight:600;font-size:16px;line-height:1.5;word-wrap:break-word;}.css-16cpc8y.ant-modal .ant-modal-content{position:relative;background-color:#ffffff;background-clip:padding-box;border:0;border-radius:8px;box-shadow:0 6px 16px 0 rgba(0, 0, 0, 0.08),0 3px 6px -4px rgba(0, 0, 0, 0.12),0 9px 28px 8px rgba(0, 0, 0, 0.05);pointer-events:auto;padding:20px 24px;}.css-16cpc8y.ant-modal .ant-modal-close{position:absolute;top:12px;right:12px;z-index:1010;padding:0;color:rgb(57,57,57);font-weight:600;line-height:1;text-decoration:none;background:transparent;border-radius:4px;width:32px;height:32px;border:0;outline:0;cursor:pointer;transition:color 0.2s,background-color 0.2s;}.css-16cpc8y.ant-modal .ant-modal-close-x{display:flex;font-size:16px;font-style:normal;line-height:32px;justify-content:center;text-transform:none;text-rendering:auto;}.css-16cpc8y.ant-modal .ant-modal-close:hover{color:#1b1b1b;background-color:rgba(0, 0, 0, 0.06);text-decoration:none;}.css-16cpc8y.ant-modal .ant-modal-close:active{background-color:rgba(0, 0, 0, 0.15);}.css-16cpc8y.ant-modal .ant-modal-close:focus-visible{outline:4px solid #c3d9f7;outline-offset:1px;transition:outline-offset 0s,outline 0s;}.css-16cpc8y.ant-modal .ant-modal-header{color:#1b1b1b;background:#ffffff;border-radius:8px 8px 0 0;margin-bottom:8px;padding:0;border-bottom:none;}.css-16cpc8y.ant-modal .ant-modal-body{font-size:14px;line-height:1.5714285714285714;word-wrap:break-word;padding:0;}.css-16cpc8y.ant-modal .ant-modal-footer{text-align:end;background:transparent;margin-top:12px;padding:0;border-top:none;border-radius:0;}.css-16cpc8y.ant-modal .ant-modal-footer >.ant-btn+.ant-btn{margin-left:8px;}.css-16cpc8y.ant-modal .ant-modal-open{overflow:hidden;}.css-16cpc8y.ant-modal-pure-panel{top:auto;padding:0;display:flex;flex-direction:column;}.css-16cpc8y.ant-modal-pure-panel .ant-modal-content,.css-16cpc8y.ant-modal-pure-panel .ant-modal-body,.css-16cpc8y.ant-modal-pure-panel .ant-modal-confirm-body-wrapper{display:flex;flex-direction:column;flex:auto;}.css-16cpc8y.ant-modal-pure-panel .ant-modal-confirm-body{margin-bottom:auto;}.css-16cpc8y.ant-modal-root .ant-modal-wrap-rtl{direction:rtl;}.css-16cpc8y.ant-modal-root .ant-modal-wrap-rtl .ant-modal-confirm-body{direction:rtl;}.css-16cpc8y.ant-modal-root .ant-modal.ant-zoom-enter,.css-16cpc8y.ant-modal-root .ant-modal.ant-zoom-appear{transform:none;opacity:0;animation-duration:0.3s;user-select:none;}.css-16cpc8y.ant-modal-root .ant-modal.ant-zoom-leave .ant-modal-content{pointer-events:none;}.css-16cpc8y.ant-modal-root .ant-modal-mask{position:fixed;top:0;right:0;bottom:0;left:0;z-index:1000;height:100%;background-color:rgba(0, 0, 0, 0.45);pointer-events:none;}.css-16cpc8y.ant-modal-root .ant-modal-mask .ant-modal-hidden{display:none;}.css-16cpc8y.ant-modal-root .ant-modal-wrap{position:fixed;top:0;right:0;bottom:0;left:0;z-index:1000;overflow:auto;outline:0;-webkit-overflow-scrolling:touch;}.css-16cpc8y.ant-modal-root .ant-fade-enter,.css-16cpc8y.ant-modal-root .ant-fade-appear{animation-duration:0.2s;animation-fill-mode:both;animation-play-state:paused;}.css-16cpc8y.ant-modal-root .ant-fade-leave{animation-duration:0.2s;animation-fill-mode:both;animation-play-state:paused;}.css-16cpc8y.ant-modal-root .ant-fade-enter.ant-fade-enter-active,.css-16cpc8y.ant-modal-root .ant-fade-appear.ant-fade-appear-active{animation-name:css-16cpc8y-antFadeIn;animation-play-state:running;}.css-16cpc8y.ant-modal-root .ant-fade-leave.ant-fade-leave-active{animation-name:css-16cpc8y-antFadeOut;animation-play-state:running;pointer-events:none;}.css-16cpc8y.ant-modal-root .ant-fade-enter,.css-16cpc8y.ant-modal-root .ant-fade-appear{opacity:0;animation-timing-function:linear;}.css-16cpc8y.ant-modal-root .ant-fade-leave{animation-timing-function:linear;}.css-16cpc8y.ant-zoom-enter,.css-16cpc8y.ant-zoom-appear{animation-duration:0.2s;animation-fill-mode:both;animation-play-state:paused;}.css-16cpc8y.ant-zoom-leave{animation-duration:0.2s;animation-fill-mode:both;animation-play-state:paused;}.css-16cpc8y.ant-zoom-enter.ant-zoom-enter-active,.css-16cpc8y.ant-zoom-appear.ant-zoom-appear-active{animation-name:css-16cpc8y-antZoomIn;animation-play-state:running;}.css-16cpc8y.ant-zoom-leave.ant-zoom-leave-active{animation-name:css-16cpc8y-antZoomOut;animation-play-state:running;pointer-events:none;}.css-16cpc8y.ant-zoom-enter,.css-16cpc8y.ant-zoom-appear{transform:scale(0);opacity:0;animation-timing-function:cubic-bezier(0.08, 0.82, 0.17, 1);}.css-16cpc8y.ant-zoom-enter-prepare,.css-16cpc8y.ant-zoom-appear-prepare{transform:none;}.css-16cpc8y.ant-zoom-leave{animation-timing-function:cubic-bezier(0.78, 0.14, 0.15, 0.86);}@keyframes css-16cpc8y-antFadeIn{0%{opacity:0;}100%{opacity:1;}}@keyframes css-16cpc8y-antFadeOut{0%{opacity:1;}100%{opacity:0;}}@keyframes css-16cpc8y-antZoomIn{0%{transform:scale(0.2);opacity:0;}100%{transform:scale(1);opacity:1;}}@keyframes css-16cpc8y-antZoomOut{0%{transform:scale(1);}100%{transform:scale(0.2);opacity:0;}}.css-16cpc8y.ant-typography{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';font-size:14px;box-sizing:border-box;}.css-16cpc8y.ant-typography::before,.css-16cpc8y.ant-typography::after{box-sizing:border-box;}.css-16cpc8y.ant-typography [class^="ant-typography"],.css-16cpc8y.ant-typography [class*=" ant-typography"]{box-sizing:border-box;}.css-16cpc8y.ant-typography [class^="ant-typography"]::before,.css-16cpc8y.ant-typography [class*=" ant-typography"]::before,.css-16cpc8y.ant-typography [class^="ant-typography"]::after,.css-16cpc8y.ant-typography [class*=" ant-typography"]::after{box-sizing:border-box;}.css-16cpc8y.ant-typography{color:#1b1b1b;word-break:break-word;line-height:1.5714285714285714;}.css-16cpc8y.ant-typography.ant-typography-secondary{color:rgb(57,57,57);}.css-16cpc8y.ant-typography.ant-typography-success{color:#52c41a;}.css-16cpc8y.ant-typography.ant-typography-warning{color:#faad14;}.css-16cpc8y.ant-typography.ant-typography-danger{color:#ff4d4f;}a.css-16cpc8y.ant-typography.ant-typography-danger:active,a.css-16cpc8y.ant-typography.ant-typography-danger:focus{color:#d9363e;}a.css-16cpc8y.ant-typography.ant-typography-danger:hover{color:#ff7875;}.css-16cpc8y.ant-typography.ant-typography-disabled{color:rgba(0, 0, 0, 0.25);cursor:not-allowed;user-select:none;}div.css-16cpc8y.ant-typography,.css-16cpc8y.ant-typography p{margin-bottom:1em;}h1.css-16cpc8y.ant-typography,div.css-16cpc8y.ant-typography-h1,div.css-16cpc8y.ant-typography-h1>textarea,.css-16cpc8y.ant-typography h1{margin-bottom:0.5em;color:#1b1b1b;font-weight:600;font-size:38px;line-height:1.2105263157894737;}h2.css-16cpc8y.ant-typography,div.css-16cpc8y.ant-typography-h2,div.css-16cpc8y.ant-typography-h2>textarea,.css-16cpc8y.ant-typography h2{margin-bottom:0.5em;color:#1b1b1b;font-weight:600;font-size:30px;line-height:1.2666666666666666;}h3.css-16cpc8y.ant-typography,div.css-16cpc8y.ant-typography-h3,div.css-16cpc8y.ant-typography-h3>textarea,.css-16cpc8y.ant-typography h3{margin-bottom:0.5em;color:#1b1b1b;font-weight:600;font-size:24px;line-height:1.3333333333333333;}h4.css-16cpc8y.ant-typography,div.css-16cpc8y.ant-typography-h4,div.css-16cpc8y.ant-typography-h4>textarea,.css-16cpc8y.ant-typography h4{margin-bottom:0.5em;color:#1b1b1b;font-weight:600;font-size:20px;line-height:1.4;}h5.css-16cpc8y.ant-typography,div.css-16cpc8y.ant-typography-h5,div.css-16cpc8y.ant-typography-h5>textarea,.css-16cpc8y.ant-typography h5{margin-bottom:0.5em;color:#1b1b1b;font-weight:600;font-size:16px;line-height:1.5;}.css-16cpc8y.ant-typography+h1.ant-typography,.css-16cpc8y.ant-typography+h2.ant-typography,.css-16cpc8y.ant-typography+h3.ant-typography,.css-16cpc8y.ant-typography+h4.ant-typography,.css-16cpc8y.ant-typography+h5.ant-typography{margin-top:1.2em;}.css-16cpc8y.ant-typography div +h1,.css-16cpc8y.ant-typography ul +h1,.css-16cpc8y.ant-typography li +h1,.css-16cpc8y.ant-typography p +h1,.css-16cpc8y.ant-typography h1 +h1,.css-16cpc8y.ant-typography h2 +h1,.css-16cpc8y.ant-typography h3 +h1,.css-16cpc8y.ant-typography h4 +h1,.css-16cpc8y.ant-typography h5 +h1,.css-16cpc8y.ant-typography div +h2,.css-16cpc8y.ant-typography ul +h2,.css-16cpc8y.ant-typography li +h2,.css-16cpc8y.ant-typography p +h2,.css-16cpc8y.ant-typography h1 +h2,.css-16cpc8y.ant-typography h2 +h2,.css-16cpc8y.ant-typography h3 +h2,.css-16cpc8y.ant-typography h4 +h2,.css-16cpc8y.ant-typography h5 +h2,.css-16cpc8y.ant-typography div +h3,.css-16cpc8y.ant-typography ul +h3,.css-16cpc8y.ant-typography li +h3,.css-16cpc8y.ant-typography p +h3,.css-16cpc8y.ant-typography h1 +h3,.css-16cpc8y.ant-typography h2 +h3,.css-16cpc8y.ant-typography h3 +h3,.css-16cpc8y.ant-typography h4 +h3,.css-16cpc8y.ant-typography h5 +h3,.css-16cpc8y.ant-typography div +h4,.css-16cpc8y.ant-typography ul +h4,.css-16cpc8y.ant-typography li +h4,.css-16cpc8y.ant-typography p +h4,.css-16cpc8y.ant-typography h1 +h4,.css-16cpc8y.ant-typography h2 +h4,.css-16cpc8y.ant-typography h3 +h4,.css-16cpc8y.ant-typography h4 +h4,.css-16cpc8y.ant-typography h5 +h4,.css-16cpc8y.ant-typography div +h5,.css-16cpc8y.ant-typography ul +h5,.css-16cpc8y.ant-typography li +h5,.css-16cpc8y.ant-typography p +h5,.css-16cpc8y.ant-typography h1 +h5,.css-16cpc8y.ant-typography h2 +h5,.css-16cpc8y.ant-typography h3 +h5,.css-16cpc8y.ant-typography h4 +h5,.css-16cpc8y.ant-typography h5 +h5{margin-top:1.2em;}.css-16cpc8y.ant-typography code{margin:0 0.2em;padding-left:0.4em;padding-right:0.4em;padding-top:0.2em;padding-bottom:0.1em;font-size:85%;font-family:'SFMono-Regular',Consolas,'Liberation Mono',Menlo,Courier,monospace;background:rgba(150, 150, 150, 0.1);border:1px solid rgba(100, 100, 100, 0.2);border-radius:3px;}.css-16cpc8y.ant-typography kbd{margin:0 0.2em;padding-left:0.4em;padding-right:0.4em;padding-top:0.15em;padding-bottom:0.1em;font-size:90%;font-family:'SFMono-Regular',Consolas,'Liberation Mono',Menlo,Courier,monospace;background:rgba(150, 150, 150, 0.06);border:1px solid rgba(100, 100, 100, 0.2);border-bottom-width:2px;border-radius:3px;}.css-16cpc8y.ant-typography mark{padding:0;background-color:#ffe58f;}.css-16cpc8y.ant-typography u,.css-16cpc8y.ant-typography ins{text-decoration:underline;text-decoration-skip-ink:auto;}.css-16cpc8y.ant-typography s,.css-16cpc8y.ant-typography del{text-decoration:line-through;}.css-16cpc8y.ant-typography strong{font-weight:600;}.css-16cpc8y.ant-typography ul,.css-16cpc8y.ant-typography ol{margin-left:0;margin-right:0;margin-top:0;margin-bottom:1em;padding:0;}.css-16cpc8y.ant-typography ul li,.css-16cpc8y.ant-typography ol li{margin-left:20px;margin-right:0;margin-top:0;margin-bottom:0;padding-left:4px;padding-right:0;padding-top:0;padding-bottom:0;}.css-16cpc8y.ant-typography ul{list-style-type:circle;}.css-16cpc8y.ant-typography ul ul{list-style-type:disc;}.css-16cpc8y.ant-typography ol{list-style-type:decimal;}.css-16cpc8y.ant-typography pre,.css-16cpc8y.ant-typography blockquote{margin:1em 0;}.css-16cpc8y.ant-typography pre{padding:0.4em 0.6em;white-space:pre-wrap;word-wrap:break-word;background:rgba(150, 150, 150, 0.1);border:1px solid rgba(100, 100, 100, 0.2);border-radius:3px;font-family:'SFMono-Regular',Consolas,'Liberation Mono',Menlo,Courier,monospace;}.css-16cpc8y.ant-typography pre code{display:inline;margin:0;padding:0;font-size:inherit;font-family:inherit;background:transparent;border:0;}.css-16cpc8y.ant-typography blockquote{padding-left:0.6em;padding-right:0;padding-top:0;padding-bottom:0;border-left:4px solid rgba(100, 100, 100, 0.2);opacity:0.85;}a.css-16cpc8y.ant-typography,.css-16cpc8y.ant-typography a{color:#416ed2;text-decoration:none;outline:none;cursor:pointer;transition:color 0.3s;}a.css-16cpc8y.ant-typography:focus,.css-16cpc8y.ant-typography a:focus,a.css-16cpc8y.ant-typography:hover,.css-16cpc8y.ant-typography a:hover{color:#305ab7;}a.css-16cpc8y.ant-typography:active,.css-16cpc8y.ant-typography a:active{color:#305ab7;}a.css-16cpc8y.ant-typography:active,.css-16cpc8y.ant-typography a:active,a.css-16cpc8y.ant-typography:hover,.css-16cpc8y.ant-typography a:hover{text-decoration:none;}a.css-16cpc8y.ant-typography[disabled],.css-16cpc8y.ant-typography a[disabled],a.css-16cpc8y.ant-typography.ant-typography-disabled,.css-16cpc8y.ant-typography a.ant-typography-disabled{color:rgba(0, 0, 0, 0.25);cursor:not-allowed;}a.css-16cpc8y.ant-typography[disabled]:active,.css-16cpc8y.ant-typography a[disabled]:active,a.css-16cpc8y.ant-typography.ant-typography-disabled:active,.css-16cpc8y.ant-typography a.ant-typography-disabled:active,a.css-16cpc8y.ant-typography[disabled]:hover,.css-16cpc8y.ant-typography a[disabled]:hover,a.css-16cpc8y.ant-typography.ant-typography-disabled:hover,.css-16cpc8y.ant-typography a.ant-typography-disabled:hover{color:rgba(0, 0, 0, 0.25);}a.css-16cpc8y.ant-typography[disabled]:active,.css-16cpc8y.ant-typography a[disabled]:active,a.css-16cpc8y.ant-typography.ant-typography-disabled:active,.css-16cpc8y.ant-typography a.ant-typography-disabled:active{pointer-events:none;}.css-16cpc8y.ant-typography .ant-typography-expand,.css-16cpc8y.ant-typography .ant-typography-edit,.css-16cpc8y.ant-typography .ant-typography-copy{color:#416ed2;text-decoration:none;outline:none;cursor:pointer;transition:color 0.3s;margin-left:4px;}.css-16cpc8y.ant-typography .ant-typography-expand:focus,.css-16cpc8y.ant-typography .ant-typography-edit:focus,.css-16cpc8y.ant-typography .ant-typography-copy:focus,.css-16cpc8y.ant-typography .ant-typography-expand:hover,.css-16cpc8y.ant-typography .ant-typography-edit:hover,.css-16cpc8y.ant-typography .ant-typography-copy:hover{color:#305ab7;}.css-16cpc8y.ant-typography .ant-typography-expand:active,.css-16cpc8y.ant-typography .ant-typography-edit:active,.css-16cpc8y.ant-typography .ant-typography-copy:active{color:#305ab7;}.css-16cpc8y.ant-typography-edit-content{position:relative;}div.css-16cpc8y.ant-typography-edit-content{left:-12px;margin-top:-12px;margin-bottom:calc(1em - 12px);}.css-16cpc8y.ant-typography-edit-content .ant-typography-edit-content-confirm{position:absolute;right:10px;bottom:8px;color:rgb(57,57,57);font-weight:normal;font-size:14px;font-style:normal;pointer-events:none;}.css-16cpc8y.ant-typography-edit-content textarea{margin:0!important;-moz-transition:none;height:1em;}.css-16cpc8y.ant-typography .ant-typography-copy-success,.css-16cpc8y.ant-typography .ant-typography-copy-success:hover,.css-16cpc8y.ant-typography .ant-typography-copy-success:focus{color:#52c41a;}.css-16cpc8y.ant-typography .ant-typography-copy-icon-only{margin-left:0;}a.css-16cpc8y.ant-typography-ellipsis,span.css-16cpc8y.ant-typography-ellipsis{display:inline-block;max-width:100%;}.css-16cpc8y.ant-typography-single-line{white-space:nowrap;}.css-16cpc8y.ant-typography-ellipsis-single-line{overflow:hidden;text-overflow:ellipsis;}a.css-16cpc8y.ant-typography-ellipsis-single-line,span.css-16cpc8y.ant-typography-ellipsis-single-line{vertical-align:bottom;}.css-16cpc8y.ant-typography-ellipsis-single-line >code{padding-top:0;padding-bottom:0;max-width:calc(100% - 1.2em);display:inline-block;overflow:hidden;text-overflow:ellipsis;vertical-align:bottom;box-sizing:content-box;}.css-16cpc8y.ant-typography-ellipsis-multiple-line{display:-webkit-box;overflow:hidden;-webkit-line-clamp:3;-webkit-box-orient:vertical;}.css-16cpc8y.ant-typography-rtl{direction:rtl;}.css-16cpc8y.ant-app{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';font-size:14px;box-sizing:border-box;}.css-16cpc8y.ant-app::before,.css-16cpc8y.ant-app::after{box-sizing:border-box;}.css-16cpc8y.ant-app [class^="ant-app"],.css-16cpc8y.ant-app [class*=" ant-app"]{box-sizing:border-box;}.css-16cpc8y.ant-app [class^="ant-app"]::before,.css-16cpc8y.ant-app [class*=" ant-app"]::before,.css-16cpc8y.ant-app [class^="ant-app"]::after,.css-16cpc8y.ant-app [class*=" ant-app"]::after{box-sizing:border-box;}.css-16cpc8y.ant-app{color:#1b1b1b;font-size:14px;line-height:1.5714285714285714;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Helvetica Neue',Arial,'Noto Sans',sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol','Noto Color Emoji';}.anticon{display:inline-flex;align-items:center;color:inherit;font-style:normal;line-height:0;text-align:center;text-transform:none;vertical-align:-0.125em;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}.anticon >*{line-height:1;}.anticon svg{display:inline-block;}.anticon .anticon .anticon-icon{display:block;}.anticon{display:inline-flex;align-items:center;color:inherit;font-style:normal;line-height:0;text-align:center;text-transform:none;vertical-align:-0.125em;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}.anticon >*{line-height:1;}.anticon svg{display:inline-block;}.anticon .anticon .anticon-icon{display:block;}:focus {
  outline: none;
}
:focus-visible {
  outline: none;
}
input::-ms-clear,
input::-ms-reveal {
  display: none;
}
*,
*::before,
*::after {
  box-sizing: border-box;
}
.container {
  margin: 0;
  text-align: left;
  font-weight: initial;
  font-family: sans-serif;
  -webkit-font-smoothing: auto;
  -moz-osx-font-smoothing: initial;
  line-height: 1.15;
  -webkit-text-size-adjust: 100%;
  -ms-text-size-adjust: 100%;
  -ms-overflow-style: scrollbar;
  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
  --font: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,
    'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji',
    'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  --cnfont:  -apple-system, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Microsoft YaHei", "Source Han Sans SC", "Noto Sans CJK SC", "WenQuanYi Micro Hei", sans-serif;
  --size: 20px;
  --width: 800px;
  --space: 0;
  --lineheight: 1.8;
  --weight: 400;
  --blockspace: 20px;
  --indent: 0em;
  --titlealign: left;
  --align: left;
  --imageleft: auto;
  --imageright: auto;
  --imagehide: block;
  --margin: 80px;
  --padding: 80px;
  --offsetleft: 0px;
  --offsetright: 0px;
  --columncount: 2;
  --columngap: 60px;
  --columnwidth: 90%;
  --title1: 2em;
  --title1weight: 500;
  --title1color: #1b1b1b;
  --title2: 1.6em;
  --title2weight: 500;
  --title2color: #1b1b1b;
  --title3: 1.2em;
  --title3weight: 500;
  --title3color: #1b1b1b;
  --title4: 1em;
  --title4weight: 500;
  --title4color: #1b1b1b;
  --title5: 1em;
  --title5weight: 500;
  --title5color: #1b1b1b;
  --title6: 1em;
  --title6weight: 500;
  --title6color: #1b1b1b;
  --color: #1b1b1b;
  --link: #416ed2;
  --hover: #305ab7;
  --visited: #305ab7;
  --select: #1b1b1b;
  --selectbg: #bbd6fc;
  --bg-r: 237;
  --bg-g: 237;
  --bg-b: 237;
  --bg: #ffffff;
  --canvas: #ededed;
  --track-width: 8px;
  --track: #e2e2e2;
  --thumb: #9e9e9e;
  --radius: 4px;
}
.container .ant-app {
  color:  #1b1b1b;
  font-size: var(--size);
  font-family:  -apple-system, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Microsoft YaHei", "Source Han Sans SC", "Noto Sans CJK SC", "WenQuanYi Micro Hei", sans-serif;
  font-weight: var(--weight);
  line-height: var(--lineheight);
  padding-left: var(--offsetleft);
  padding-right: var(--offsetright);
}
@-ms-viewport {
  width: device-width;
}
[tabindex='-1']:focus {
  outline: none;
}
hr {
  box-sizing: content-box;
  height: 0;
  overflow: visible;
}
h1,
h2,
h3,
h4,
h5,
h6 {
  margin-top: 0;
  margin-bottom: 0.5em;
  font-weight: 500;
}
p {
  margin-top: 0;
  margin-bottom: 1em;
}
abbr[title],
abbr[data-original-title] {
  -webkit-text-decoration: underline dotted;
  text-decoration: underline;
  text-decoration: underline dotted;
  border-bottom: 0;
  cursor: help;
}
address {
  margin-bottom: 1em;
  font-style: normal;
  line-height: inherit;
}
input[type='text'],
input[type='password'],
input[type='number'],
textarea {
  -webkit-appearance: none;
}
ol,
ul,
dl {
  margin-top: 0;
  margin-bottom: 1em;
}
ol ol,
ul ul,
ol ul,
ul ol {
  margin-bottom: 0;
}
dt {
  font-weight: 500;
}
dd {
  margin-bottom: 0.5em;
  margin-left: 0;
}
blockquote {
  margin: 0 0 1em;
}
dfn {
  font-style: italic;
}
b,
strong {
  font-weight: bolder;
}
small {
  font-size: 80%;
}
sub,
sup {
  position: relative;
  font-size: 75%;
  line-height: 0;
  vertical-align: baseline;
}
sub {
  bottom: -0.25em;
}
sup {
  top: -0.5em;
}
pre,
code,
kbd,
samp {
  font-size: 1em;
  font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace;
}
pre {
  margin-top: 0;
  margin-bottom: 1em;
  overflow: auto;
}
figure {
  margin: 0 0 1em;
}
img {
  vertical-align: middle;
  border-style: none;
}
a,
area,
button,
[role='button'],
input:not([type='range']),
label,
select,
summary,
textarea {
  touch-action: manipulation;
}
table {
  border-collapse: collapse;
}
caption {
  padding-top: 0.75em;
  padding-bottom: 0.3em;
  text-align: left;
  caption-side: bottom;
}
input,
button,
select,
optgroup,
textarea {
  margin: 0;
  color: inherit;
  font-size: inherit;
  font-family: inherit;
  line-height: inherit;
}
button,
input {
  overflow: visible;
}
button,
select {
  text-transform: none;
}
button,
html [type='button'],
[type='reset'],
[type='submit'] {
  -webkit-appearance: button;
}
button::-moz-focus-inner,
[type='button']::-moz-focus-inner,
[type='reset']::-moz-focus-inner,
[type='submit']::-moz-focus-inner {
  padding: 0;
  border-style: none;
}
input[type='radio'],
input[type='checkbox'] {
  box-sizing: border-box;
  padding: 0;
}
input[type='date'],
input[type='time'],
input[type='datetime-local'],
input[type='month'] {
  -webkit-appearance: listbox;
}
textarea {
  overflow: auto;
  resize: vertical;
}
fieldset {
  min-width: 0;
  margin: 0;
  padding: 0;
  border: 0;
}
legend {
  display: block;
  width: 100%;
  max-width: 100%;
  margin-bottom: 0.5em;
  padding: 0;
  color: inherit;
  font-size: 1.5em;
  line-height: inherit;
  white-space: normal;
}
progress {
  vertical-align: baseline;
}
[type='number']::-webkit-inner-spin-button,
[type='number']::-webkit-outer-spin-button {
  height: auto;
}
[type='search'] {
  outline-offset: -2px;
  -webkit-appearance: none;
}
[type='search']::-webkit-search-cancel-button,
[type='search']::-webkit-search-decoration {
  -webkit-appearance: none;
}
::-webkit-file-upload-button {
  font: inherit;
  -webkit-appearance: button;
}
output {
  display: inline-block;
}
summary {
  display: list-item;
}
template {
  display: none;
}
[hidden] {
  display: none !important;
}
mark {
  padding: 0.2em;
}

.copyright {
  line-height: normal;
  display: flex;
  align-items: center;
  flex-direction: column;
  padding-bottom: 20px;
}
.copyright .ant-btn.ant-btn-lg.ant-btn-icon-only {
  width: auto;
  height: auto;
  opacity: 0.2;
  padding: 7px 10px;
}
.copyright .ant-btn.ant-btn-lg.ant-btn-icon-only svg {
  width: 40px;
  height: 40px;
}
.copyright .ant-btn.ant-btn-lg.ant-btn-icon-only:hover {
  opacity: 1;
  background: transparent;
}
.copyright .ant-btn.ant-btn-lg.ant-btn-icon-only.like:hover {
  color: #f10606;
}
.copyright .ant-btn.ant-btn-lg.ant-btn-icon-only.unlike:hover {
  color: #e7c207;
}
.copyright .ant-btn.ant-btn-lg.ant-btn-icon-only.coffee:hover {
  color: #ce6a07;
}
.copyright .ant-btn.ant-btn-sm {
  font-size: 12px;
  opacity: 0.4;
  padding-left: 6px;
  padding-right: 6px;
  height: auto;
}
.copyright .ant-btn.ant-btn-sm:hover {
  opacity: 1;
}
.copyright .ant-typography.ant-typography-secondary {
  font-size: 12px;
  opacity: 0.5;
  margin-top: 3px;
}

.container .ant-app {
  min-height: 100vh;
}
.container a {
  text-decoration: none;
}
.container code,
.container tt {
  border-radius: 3px;
  padding: 0 5px;
  margin: 0 5px;
}
.container pre {
  padding: 0.6em 0.8em;
  word-wrap: break-word;
  border-radius: 3px;
}
.container pre code {
  display: inline;
  margin: 0;
  padding: 0;
  background: 0 0;
  border: 0;
}
.container kbd {
  margin: 0 0.2em;
  padding: 0.15em 0.4em 0.1em;
  font-size: 90%;
  border-bottom-width: 2px;
  border-radius: 3px;
}
.container blockquote {
  padding: 0.1em 1em;
  opacity: 0.85;
}
.container blockquote > :first-child {
  margin-top: 0px;
}
.container blockquote > :last-child {
  margin-bottom: 0px;
}
.container blockquote p {
  margin: 0;
}
.container hr {
  clear: both;
  margin: 15px 0;
  height: 0px;
  overflow: hidden;
  border: none;
  background: transparent;
  padding: 0;
}
.container table {
  width: 100%;
  max-width: 100%;
  border-collapse: collapse;
}
.container table pre {
  white-space: pre-wrap;
}
.container figure {
  overflow: auto;
}
.container figure > img,
.container figure > table,
.container figure > pre {
  margin: 0 !important;
}
.container tr th,
.container tr td {
  padding: 6px 13px;
}
.container tr th p {
  margin: 0;
}
.container img {
  object-fit: contain;
}
.container img,
.container video {
  max-width: 100%;
  height: auto;
}
.container embed {
  max-width: 100%;
}
.container li div,
.container li p {
  margin: 0;
}
.container mark {
  padding: 0;
  margin: 0;
  color: initial;
  background-color: initial;
}
.container :focus {
  outline: none;
}
.container [role='separator']::after {
  content: '';
  display: block;
  clear: both;
  margin: 25px 0;
  height: 2px;
  overflow: hidden;
  border: none;
  opacity: 0.1;
  background:  #1b1b1b;
  padding: 0;
}
.container [role='separator']:last-child::after {
  display: none;
}
.container .line {
  display: block;
}
.container .left {
  float: left;
  margin-right: 12px;
}
.container .right {
  float: right;
  margin-left: 12px;
}
.container .both {
  clear: both;
}
.container .full-width {
  width: 100%;
  max-width: 100% !important;
}
.container .noise {
  display: none !important;
}
.container .block {
  display: block;
}
.container .inline-block {
  display: inline-block;
}
.container .flex {
  display: flex;
  flex-wrap: wrap;
}
.container .inline-flex {
  display: inline-flex;
  flex-wrap: wrap;
}
.container .zone-width {
  min-width: 0;
}

.container {
  color:  #1b1b1b;
  background:  #ffffff;
}
.container code,
.container tt {
  border: 1px solid rgba( 237,  237,  237, 0.6);
  background: rgba( 237,  237,  237, 0.4);
}
.container pre {
  background: rgba( 237,  237,  237, 0.5);
}
.container kbd {
  border: 1px solid rgba( 237,  237,  237, 1);
}
.container blockquote {
  border-left: 4px solid rgba( 237,  237,  237, 1);
}
.container hr {
  border-bottom: 1px solid rgba( 237,  237,  237, 1);
}
.container table th:hover,
.container table tr:hover {
  background: rgba( 237,  237,  237, 0.6);
}
.container table tr {
  border-bottom: 1px solid rgba( 237,  237,  237, 0.6);
}
.container table thead tr:first-child,
.container table tbody tr:first-child {
  background: rgba( 237,  237,  237, 0.4);
}
.container table thead + tbody tr:first-child {
  background: transparent;
}
.container table tr td {
  border-inline-end: 1px solid  rgb(237, 237, 237);
}
.container h1,
.container h2,
.container h3,
.container h4,
.container h5,
.container h6 {
  color:  #1b1b1b;
}
.container a {
  color:  #416ed2;
}
.container a:hover {
  color:  #305ab7;
}
.container a:active {
  color:  #305ab7;
}
.container a:visited {
  color:  #305ab7;
}
.container ::selection {
  color:  #1b1b1b;
  background-color:  #bbd6fc;
}
.container .title a {
  color:  #1b1b1b;
}
.container .title a:hover {
  color:  #416ed2;
}
.container .footer {
  color:  #1b1b1b;
}
.container.solid {
  background:  rgb(237, 237, 237);
}

.container {
  padding: 1px;
  text-shadow: none;
  font-variant: tabular-nums;
  font-feature-settings: 'tnum';
}
.container h1 {
  font-size: var(--title1);
  color:  #1b1b1b;
  font-weight: var(--title1weight);
}
.container h2 {
  font-size: var(--title2);
  color:  #1b1b1b;
  font-weight: var(--title2weight);
}
.container h3 {
  font-size: var(--title3);
  color:  #1b1b1b;
  font-weight: var(--title3weight);
}
.container h4 {
  font-size: var(--title4);
  color:  #1b1b1b;
  font-weight: var(--title4weight);
}
.container h5 {
  font-size: var(--title5);
  color:  #1b1b1b;
  font-weight: var(--title5weight);
}
.container h6 {
  font-size: var(--title6);
  color:  #1b1b1b;
  font-weight: var(--title6weight);
}
.container h1,
.container h2,
.container h3,
.container h4,
.container h5,
.container h6 {
  text-indent: 0;
}
.container a.link {
  margin: 0 6px;
}
.container a.link-with-img {
  display: inline-block;
}
.container a.link-with-img img {
  margin: 0 !important;
}
.container ol,
.container ul {
  text-indent: 0;
}
.container pre {
  white-space: pre-wrap;
}
.container pre,
.container code,
.container blockquote {
  text-indent: 0;
  text-align: left;
}
.container p,
.container blockquote,
.container ul,
.container ol,
.container dl,
.container table,
.container pre,
.container section,
.container figcaption,
.container li,
.container .block {
  margin: var(--blockspace) 0;
}
.container table {
  width: var(--width);
  max-width: var(--width);
  border-top: 1px solid  rgb(237, 237, 237);
  border-bottom: 1px solid  rgb(237, 237, 237);
}
.container .flex p,
.container .inline-flex p,
.container .flex blockquote,
.container .inline-flex blockquote,
.container .flex ul,
.container .inline-flex ul,
.container .flex ol,
.container .inline-flex ol,
.container .flex dl,
.container .inline-flex dl,
.container .flex table,
.container .inline-flex table,
.container .flex pre,
.container .inline-flex pre,
.container .flex section,
.container .inline-flex section,
.container .flex figcaption,
.container .inline-flex figcaption,
.container .flex .block,
.container .inline-flex .block {
  margin: 0;
}
.container .flex > *,
.container .inline-flex > * {
  margin-left: 10px !important;
  margin-right: 10px !important;
}
.container .flex > *:first-child,
.container .inline-flex > *:first-child {
  margin-left: 0 !important;
}
.container .flex > *:last-child,
.container .inline-flex > *:last-child {
  margin-right: 0 !important;
}
.container .pages {
  min-height: 610px;
  max-width: var(--width);
  margin:  80px auto;
}
.container .pages svg {
  width: 20px;
  height: 20px;
}
.container .pages .MathJax_SVG svg {
  width: auto;
  height: auto;
}
.container .page {
  padding-bottom: 20px;
  margin-bottom: 20px;
  word-break: break-word;
  text-indent: var(--indent);
  letter-spacing: var(--space);
  text-align: var(--align);
}
.container .page > *:first-child {
  margin-top: 0;
}
.container .page > *:last-child {
  margin-bottom: 0;
}
.container .page:last-child {
  margin-bottom: 0;
  border-bottom-width: 0;
}
.container .page:before,
.container .page:after {
  content: '';
  display: block;
  clear: both;
  height: 0px;
}
.container .page img {
  display: var(--imagehide);
}
.container .page img.large {
  margin-top: var(--blockspace) !important;
  margin-bottom: var(--blockspace) !important;
  margin-left: var(--imageleft) !important;
  margin-right: var(--imageright) !important;
}
.container .page img.tiny,
.container .page img.base64 {
  width: auto;
}
.container .page figure {
  overflow: auto;
}
.container .page figure > img.large,
.container .page figure > table,
.container .page figure > pre {
  margin-top: 0 !important;
  margin-bottom: 0 !important;
}
.container .page figure > figcaption {
  text-align: center;
  font-size: 90%;
  opacity: 0.8;
  margin-top: 6px;
}
.container .page p > img.large,
.container .page a img {
  margin-top: 0 !important;
  margin-bottom: 0 !important;
}
.container .page .title {
  text-indent: 0;
  margin-bottom: 0;
  text-align: var(--titlealign);
}
.container .page .meta {
  font-size: 80%;
  text-indent: 0;
  text-align: var(--titlealign);
  margin: 0 0 var(--blockspace);
}
.container .page .meta > span {
  opacity: 0.7;
  position: relative;
  margin-right: 24px;
}
.container .page .meta > span.ant-avatar {
  margin-right: 2px;
}
.container .page .meta > span.ant-avatar img {
  display: block;
}
.container .page .meta > span::after {
  content: '';
  position: absolute;
  right: -12px;
  top: 47%;
  display: block;
  width: 3px;
  height: 3px;
  background:  #1b1b1b;
  border-radius: 50%;
}
.container .page .meta > span:last-child::after {
  display: none;
}
.container .page .meta.avatar .ant-avatar {
  float: left;
  opacity: 1;
  width: 46px;
  height: 46px;
  margin-right: 16px;
  background:  #ffffff;
  border-radius: 6px;
  overflow: hidden;
}
.container .page .meta.avatar .ant-avatar img {
  display: block;
}
.container .page .meta.avatar .author {
  opacity: 1;
  line-height: 1.3;
  display: block;
}
.container .page .meta.avatar .author::after {
  display: none;
}
.container .page .meta::after {
  content: '';
  display: block;
  clear: both;
}
.container .page .excerpt {
  text-indent: 0;
  border-color:  #416ed2;
  background:  rgb(237, 237, 237);
}
.container .page .excerpt p {
  font-size: 90%;
}
.container .page .cover {
  text-indent: 0;
  margin-bottom: var(--blockspace);
}
.container .page .cover .ant-image {
  width: 100%;
  background: #f5f5f5;
}
.container .page .cover img {
  margin: 0 !important;
  width: 100%;
}
.container .page .footer {
  text-indent: 0;
  margin: calc(var(--blockspace) * 2) 0 0;
}
.container .page .footer .ant-tag {
  cursor: pointer;
  min-height: 27px;
  border-radius: 15px;
  background:  #ffffff;
  padding: 3px 12px 3px 3px;
  margin: 0 5px 4px 0;
  display: inline-block;
}
.container .page .footer .ant-tag::before {
  content: '#';
  margin-right: 4px;
  background:  rgb(237, 237, 237);
  width: 20px;
  height: 20px;
  text-align: center;
  font-size: 12px;
  color:  #416ed2;
  line-height: 20px;
  border-radius: 50px;
  display: inline-block;
}
.container .page .footer .ant-tag:hover {
  color:  #1b1b1b;
  background-color:  #bbd6fc;
}
.container .page .page-empty.ant-result {
  padding: 180px 0;
}
.container .page .page-empty.ant-result .ant-result-icon svg {
  width: auto;
  height: auto;
}
.container .page.zh {
  font-family:  -apple-system, BlinkMacSystemFont, "Helvetica Neue", "PingFang SC", "Microsoft YaHei", "Source Han Sans SC", "Noto Sans CJK SC", "WenQuanYi Micro Hei", sans-serif;
}
.container .tex,
.container .katex-display {
  text-align: center;
  margin: 50px 0;
}
.container .sub-page::before {
  content: '';
  display: block;
  height: var(--blockspace);
  border-top: 1px solid  #1b1b1b;
  opacity: 0.1;
  margin-left: calc(-1 *  80px);
  margin-right: calc(-1 *  80px);
}
.container .sub-page .sub-title {
  margin-bottom: -2px;
}
@media screen and (max-width: 600px) {
  .container .pages {
    margin: 20px 16px;
  }
}

.container.paper {
  background:  rgb(237, 237, 237);
}
.container.paper table {
  margin: var(--blockspace) calc( 80px * -1);
}
.container.paper .page {
  border-radius: 6px;
  background:  #ffffff;
  padding:  80px;
  box-shadow: 0 0 6px rgba(0, 0, 0, 0.15);
}
.container.paper .page .cover {
  margin: var(--blockspace) calc( 80px * -1);
}
.container.paper .page-block {
  padding-left:  80px;
  padding-right:  80px;
}
.container.paper .page-block .cover {
  margin: 0;
  max-width: 100%;
}
@media screen and (max-width: 600px) {
  .container.paper .page {
    padding: 20px;
  }
  .container.paper .page .cover {
    max-width: calc(100% + 40px);
    margin: -10px -20px 0;
  }
}

@media print {
  .container {
    padding-right: 0 !important;
  }
  .container .pages {
    margin: 0;
    max-width: 100%;
  }
  .container .pages pre,
  .container .pages img,
  .container .pages table {
    break-inside: avoid;
    page-break-inside: avoid;
  }
  .container .page-block {
    column-count: auto;
    margin-bottom: 0;
    padding-bottom: 0;
    padding-top: 0;
  }
  .container.paper .page {
    box-shadow: none;
  }
}

.container.shot.paper .page {
  border-radius: 0;
  box-shadow: none;
}

@-webkit-keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-transform: translate3d(0, 1600px, 0);
    transform: translate3d(0, 1600px, 0);
  }

  100% {
    opacity: 1;
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
  }
}

@keyframes fadeIn {
  0% {
    opacity: 0;
    -webkit-transform: translate3d(0, 1600px, 0);
    transform: translate3d(0, 1600px, 0);
  }

  100% {
    opacity: 1;
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
  }
}

@-webkit-keyframes fadeOut {
  0% {
    opacity: 1;
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
  }

  100% {
    opacity: 0;
    -webkit-transform: translate3d(0, 1600px, 0);
    transform: translate3d(0, 1600px, 0);
  }
}

@keyframes fadeOut {
  0% {
    opacity: 1;
    -webkit-transform: translate3d(0, 0, 0);
    transform: translate3d(0, 0, 0);
  }

  100% {
    opacity: 0;
    -webkit-transform: translate3d(0, 1600px, 0);
    transform: translate3d(0, 1600px, 0);
  }
}

.container.in .pages {
  -webkit-animation-name: fadeIn;
  animation-name: fadeIn;
  -webkit-animation-duration: .3s;
  animation-duration: .3s;
  -webkit-animation-fill-mode: both;
  animation-fill-mode: both;
}

.container.out .pages {
  -webkit-animation-name: fadeOut;
  animation-name: fadeOut;
  -webkit-animation-duration: .2s;
  animation-duration: .2s;
  -webkit-animation-fill-mode: both;
  animation-fill-mode: both;
}

    .container {
      --codefont: inherit;
      --codesize: 20px;
      --codelineheight: 1;
      --codecomment: #697070;
      --codetag: #444a;
      --codeattr: #444a;
      --codenumber: #800;
      --codeblock: #800;
      --codevariable: #ab5656;
      --codeliteral: #695;
      --code: #397300;
      --codemeta: #1f7199;
      --codestring: #38a;
    }
    .hljs {
      border-radius: 3px;
      font-family: var(--codefont);
      font-size: var(--codesize);
      line-height: var(--codelineheight);
    }
    .hljs.large {
      position: fixed;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      padding: 50px;
      background:  #ffffff;
      z-index: 600;
      margin: 0;
      word-break: break-word;
      overflow: auto;
      white-space: pre-wrap;
    }
    
    .hljs-comment {
      color: var(--codecomment);
    }
    .hljs-punctuation,
    .hljs-tag {
      color: var(--codetag);
    }
    .hljs-tag .hljs-attr,
    .hljs-tag .hljs-name {
      color: var(--codeattr);
    }
    .hljs-attribute,
    .hljs-doctag,
    .hljs-keyword,
    .hljs-meta .hljs-keyword,
    .hljs-name,
    .hljs-selector-tag {
      font-weight: 700;
    }
    .hljs-deletion,
    .hljs-number,
    .hljs-quote,
    .hljs-selector-class,
    .hljs-selector-id,
    .hljs-string,
    .hljs-template-tag,
    .hljs-type {
      color: var(--codenumber);
    }
    .hljs-section,
    .hljs-title {
      color: var(--codeblock);
      font-weight: 700;
    }
    .hljs-link,
    .hljs-operator,
    .hljs-regexp,
    .hljs-selector-attr,
    .hljs-selector-pseudo,
    .hljs-symbol,
    .hljs-template-variable,
    .hljs-variable {
      color: var(--codevariable);
    }
    .hljs-literal {
      color: var(--codeliteral);
    }
    .hljs-addition,
    .hljs-built_in,
    .hljs-bullet,
    .hljs-code {
      color: var(--code);
    }
    .hljs-meta {
      color: var(--codemeta);
    }
    .hljs-meta .hljs-string {
      color: var(--codestring);
    }
    .hljs-emphasis {
      font-style: italic;
    }
    .hljs-strong {
      font-weight: 700;
    }
    img[action="zoom-in"] {cursor: zoom-in;}</style><title>端侧multi head attention优化浅析 - Circle 阅读助手</title></head><body><div class=" container paper in"><div class="ant-app"><div class="pages"><div class="page"><h1 class="title" id="outline_0"><a href="https://zhuanlan.zhihu.com/p/22632240119" target="_blank" rel="noreferrer">端侧multi head attention优化浅析</a></h1><p class="meta avatar"><span class="ant-avatar ant-avatar-circle ant-avatar-image css-16cpc8y"><img src="https://picx.zhimg.com/90a3a41bd_l.jpg?source=172ae18b 2x" class="tiny"></span><span class="author">生死看淡不服就干</span><span>2025-02-11 07:06</span><span>共 9956 字</span><span>阅读需 40.5 分钟</span></p><p></p><h3 id="outline_1">前言</h3><p>本文结合业界一些主流做法，参考了<span><a href="https://zhida.zhihu.com/search?content_id=253548761&amp;content_type=Article&amp;match_order=1&amp;q=MNN&amp;zhida_source=entity" target="_blank" class="link">MNN</a></span>，苹果，高通等在客户端上部署的经验。看一下业界的大佬们是如何在端上优化transformer的。当然这只是我自己的理解，会有非常多的错误，抛砖引玉，欢迎各位大佬指正。</p><p>各种attention的表示方法</p><ul><li>scale dot_production attention</li></ul><p>这个就是标准的attention，，直接上图</p><p><img src="https://pic1.zhimg.com/v2-d60fddef6521c0cab718dd5953cb334c_r.jpg" class="large"></p><p>也就是下面的这个公式</p><p><span><span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mtext>Attention</mtext><mo stretchy=&quot;false&quot;>(</mo><mi>Q</mi><mo>,</mo><mi>K</mi><mo>,</mo><mi>V</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mtext>softmax</mtext><mrow><mo>(</mo><mfrac><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac><mo>)</mo></mrow><mi>V</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="41.154ex" height="6.032ex" viewBox="0 -1548 17718.9 2597.3" role="img" focusable="false" aria-hidden="true" style="vertical-align: -2.437ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-41"></use><use xlink:href="#MJMAIN-74" x="750" y="0"></use><use xlink:href="#MJMAIN-74" x="1140" y="0"></use><use xlink:href="#MJMAIN-65" x="1529" y="0"></use><use xlink:href="#MJMAIN-6E" x="1974" y="0"></use><use xlink:href="#MJMAIN-74" x="2530" y="0"></use><use xlink:href="#MJMAIN-69" x="2920" y="0"></use><use xlink:href="#MJMAIN-6F" x="3198" y="0"></use><use xlink:href="#MJMAIN-6E" x="3699" y="0"></use><use xlink:href="#MJMAIN-28" x="4255" y="0"></use><use xlink:href="#MJMATHI-51" x="4645" y="0"></use><use xlink:href="#MJMAIN-2C" x="5436" y="0"></use><use xlink:href="#MJMATHI-4B" x="5881" y="0"></use><use xlink:href="#MJMAIN-2C" x="6771" y="0"></use><use xlink:href="#MJMATHI-56" x="7216" y="0"></use><use xlink:href="#MJMAIN-29" x="7985" y="0"></use><use xlink:href="#MJMAIN-3D" x="8653" y="0"></use><g transform="translate(9709,0)"><use xlink:href="#MJMAIN-73"></use><use xlink:href="#MJMAIN-6F" x="394" y="0"></use><use xlink:href="#MJMAIN-66" x="895" y="0"></use><use xlink:href="#MJMAIN-74" x="1201" y="0"></use><use xlink:href="#MJMAIN-6D" x="1591" y="0"></use><use xlink:href="#MJMAIN-61" x="2424" y="0"></use><use xlink:href="#MJMAIN-78" x="2925" y="0"></use></g><g transform="translate(13329,0)"><use xlink:href="#MJSZ3-28"></use><g transform="translate(736,0)"><g transform="translate(120,0)"><rect stroke="none" width="1740" height="60" x="0" y="220"></rect><g transform="translate(60,541)"><use transform="scale(0.707)" xlink:href="#MJMATHI-51" x="0" y="0"></use><g transform="translate(559,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4B" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="#MJMATHI-54" x="1275" y="581"></use></g></g><g transform="translate(166,-566)"><use transform="scale(0.707)" xlink:href="#MJSZ1-221A" x="0" y="25"></use><rect stroke="none" width="699" height="42" x="707" y="577"></rect><g transform="translate(707,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-64" x="0" y="0"></use><use transform="scale(0.5)" xlink:href="#MJMATHI-6B" x="736" y="-213"></use></g></g></g></g><use xlink:href="#MJSZ3-29" x="2716" y="-1"></use></g><use xlink:href="#MJMATHI-56" x="16949" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mtext>Attention</mtext><mo stretchy="false">(</mo><mi>Q</mi><mo>,</mo><mi>K</mi><mo>,</mo><mi>V</mi><mo stretchy="false">)</mo><mo>=</mo><mtext>softmax</mtext><mrow><mo>(</mo><mfrac><mrow><mi>Q</mi><msup><mi>K</mi><mi>T</mi></msup></mrow><msqrt><msub><mi>d</mi><mi>k</mi></msub></msqrt></mfrac><mo>)</mo></mrow><mi>V</mi></math></span></span><span class="tex2jax_ignore math-holder">\text{Attention}(Q, K, V) = \text{softmax}\left(\frac{QK^T}{\sqrt{d_k}}\right)V</span></span></span> </p><ul><li><span><a href="https://zhida.zhihu.com/search?content_id=253548761&amp;content_type=Article&amp;match_order=1&amp;q=self+attention&amp;zhida_source=entity" target="_blank" class="link">self attention</a></span></li></ul><p>Self attention的意思是上图的Q，K，V都是来自同一个来源,如下图所示</p><p><img src="https://pic4.zhimg.com/v2-1c016046dcb459e6fe169cb11b222b87_r.jpg" class="large"></p><p>这上面的图没有截全，只有QK^T部分，这一个部分算出来的就是attention matrix,也有人叫做socre matrix。具体为什么这样叫，可以看<a href="https://link.zhihu.com/?target=https%3A//www.youtube.com/playlist%3Flist%3DPLAqhIrjkxbuWI23v9cThsA9GvCAUhRvKZ" target="_blank" rel="nofollow noreferrer" class="link">Neural Networks: Zero to Hero</a> 这个系列的第二部，他说这个matrix的由来。</p><ul><li><span><a href="https://zhida.zhihu.com/search?content_id=253548761&amp;content_type=Article&amp;match_order=1&amp;q=multihead+attention&amp;zhida_source=entity" target="_blank" class="link">multihead attention</a></span>(MHA)</li></ul><p>MHA，那就是多个self attention合并起来，详见下图。</p><p><img src="https://pic3.zhimg.com/v2-60521c7b35b6484da7620dcb74030c02_r.jpg" class="large"></p><p><span><span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>M</mi><mi>u</mi><mi>l</mi><mi>t</mi><mi>i</mi><mi>H</mi><mi>e</mi><mi>a</mi><mi>d</mi><mo stretchy=&quot;false&quot;>(</mo><mi>Q</mi><mo>,</mo><mi>K</mi><mo>,</mo><mi>V</mi><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mi>C</mi><mi>o</mi><mi>n</mi><mi>c</mi><mi>a</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mn>1</mn><mo>,</mo><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mn>2</mn><mo>,</mo><mo>&amp;#x2026;</mo><mo>,</mo><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi>h</mi><mo stretchy=&quot;false&quot;>)</mo><msub><mi>W</mi><mi>O</mi></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="61.702ex" height="2.789ex" viewBox="0 -849.8 26565.9 1200.9" role="img" focusable="false" aria-hidden="true" style="vertical-align: -0.815ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-4D" x="0" y="0"></use><use xlink:href="#MJMATHI-75" x="1051" y="0"></use><use xlink:href="#MJMATHI-6C" x="1624" y="0"></use><use xlink:href="#MJMATHI-74" x="1922" y="0"></use><use xlink:href="#MJMATHI-69" x="2284" y="0"></use><use xlink:href="#MJMATHI-48" x="2629" y="0"></use><use xlink:href="#MJMATHI-65" x="3518" y="0"></use><use xlink:href="#MJMATHI-61" x="3984" y="0"></use><use xlink:href="#MJMATHI-64" x="4514" y="0"></use><use xlink:href="#MJMAIN-28" x="5037" y="0"></use><use xlink:href="#MJMATHI-51" x="5427" y="0"></use><use xlink:href="#MJMAIN-2C" x="6218" y="0"></use><use xlink:href="#MJMATHI-4B" x="6663" y="0"></use><use xlink:href="#MJMAIN-2C" x="7553" y="0"></use><use xlink:href="#MJMATHI-56" x="7998" y="0"></use><use xlink:href="#MJMAIN-29" x="8767" y="0"></use><use xlink:href="#MJMAIN-3D" x="9435" y="0"></use><use xlink:href="#MJMATHI-43" x="10491" y="0"></use><use xlink:href="#MJMATHI-6F" x="11251" y="0"></use><use xlink:href="#MJMATHI-6E" x="11737" y="0"></use><use xlink:href="#MJMATHI-63" x="12337" y="0"></use><use xlink:href="#MJMATHI-61" x="12771" y="0"></use><use xlink:href="#MJMATHI-74" x="13300" y="0"></use><use xlink:href="#MJMAIN-28" x="13662" y="0"></use><use xlink:href="#MJMATHI-68" x="14051" y="0"></use><use xlink:href="#MJMATHI-65" x="14628" y="0"></use><use xlink:href="#MJMATHI-61" x="15094" y="0"></use><use xlink:href="#MJMATHI-64" x="15624" y="0"></use><use xlink:href="#MJMAIN-31" x="16147" y="0"></use><use xlink:href="#MJMAIN-2C" x="16648" y="0"></use><use xlink:href="#MJMATHI-68" x="17093" y="0"></use><use xlink:href="#MJMATHI-65" x="17670" y="0"></use><use xlink:href="#MJMATHI-61" x="18136" y="0"></use><use xlink:href="#MJMATHI-64" x="18666" y="0"></use><use xlink:href="#MJMAIN-32" x="19189" y="0"></use><use xlink:href="#MJMAIN-2C" x="19690" y="0"></use><use xlink:href="#MJMAIN-2026" x="20135" y="0"></use><use xlink:href="#MJMAIN-2C" x="21474" y="0"></use><use xlink:href="#MJMATHI-68" x="21919" y="0"></use><use xlink:href="#MJMATHI-65" x="22496" y="0"></use><use xlink:href="#MJMATHI-61" x="22962" y="0"></use><use xlink:href="#MJMATHI-64" x="23492" y="0"></use><use xlink:href="#MJMATHI-68" x="24015" y="0"></use><use xlink:href="#MJMAIN-29" x="24592" y="0"></use><g transform="translate(24981,0)"><use xlink:href="#MJMATHI-57" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-4F" x="1335" y="-218"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>M</mi><mi>u</mi><mi>l</mi><mi>t</mi><mi>i</mi><mi>H</mi><mi>e</mi><mi>a</mi><mi>d</mi><mo stretchy="false">(</mo><mi>Q</mi><mo>,</mo><mi>K</mi><mo>,</mo><mi>V</mi><mo stretchy="false">)</mo><mo>=</mo><mi>C</mi><mi>o</mi><mi>n</mi><mi>c</mi><mi>a</mi><mi>t</mi><mo stretchy="false">(</mo><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mn>1</mn><mo>,</mo><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mn>2</mn><mo>,</mo><mo>…</mo><mo>,</mo><mi>h</mi><mi>e</mi><mi>a</mi><mi>d</mi><mi>h</mi><mo stretchy="false">)</mo><msub><mi>W</mi><mi>O</mi></msub></math></span></span><span class="tex2jax_ignore math-holder">MultiHead(Q,K,V)=Concat(head1,head2,…,headh)W_O</span></span></span> </p><p>其中每个头的计算为：</p><p><span><span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>h</mi><mi>e</mi><mi>a</mi><msub><mi>d</mi><mi>i</mi></msub><mo>=</mo><mi>A</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo stretchy=&quot;false&quot;>(</mo><mi>Q</mi><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>Q</mi></mrow></msub><mo>,</mo><mi>K</mi><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>K</mi></mrow></msub><mo>,</mo><mi>V</mi><msub><mi>W</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>V</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="41.398ex" height="2.789ex" viewBox="0 -849.8 17823.9 1200.9" role="img" focusable="false" aria-hidden="true" style="vertical-align: -0.815ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMATHI-68" x="0" y="0"></use><use xlink:href="#MJMATHI-65" x="576" y="0"></use><use xlink:href="#MJMATHI-61" x="1043" y="0"></use><g transform="translate(1572,0)"><use xlink:href="#MJMATHI-64" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="736" y="-213"></use></g><use xlink:href="#MJMAIN-3D" x="2715" y="0"></use><use xlink:href="#MJMATHI-41" x="3771" y="0"></use><use xlink:href="#MJMATHI-74" x="4521" y="0"></use><use xlink:href="#MJMATHI-74" x="4883" y="0"></use><use xlink:href="#MJMATHI-65" x="5244" y="0"></use><use xlink:href="#MJMATHI-6E" x="5711" y="0"></use><use xlink:href="#MJMATHI-74" x="6311" y="0"></use><use xlink:href="#MJMATHI-69" x="6673" y="0"></use><use xlink:href="#MJMATHI-6F" x="7018" y="0"></use><use xlink:href="#MJMATHI-6E" x="7504" y="0"></use><use xlink:href="#MJMAIN-28" x="8104" y="0"></use><use xlink:href="#MJMATHI-51" x="8494" y="0"></use><g transform="translate(9285,0)"><use xlink:href="#MJMATHI-57" x="0" y="0"></use><g transform="translate(944,-155)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-51" x="345" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="11134" y="0"></use><use xlink:href="#MJMATHI-4B" x="11579" y="0"></use><g transform="translate(12469,0)"><use xlink:href="#MJMATHI-57" x="0" y="0"></use><g transform="translate(944,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-4B" x="345" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="14386" y="0"></use><use xlink:href="#MJMATHI-56" x="14831" y="0"></use><g transform="translate(15601,0)"><use xlink:href="#MJMATHI-57" x="0" y="0"></use><g transform="translate(944,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-56" x="345" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="17434" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>h</mi><mi>e</mi><mi>a</mi><msub><mi>d</mi><mi>i</mi></msub><mo>=</mo><mi>A</mi><mi>t</mi><mi>t</mi><mi>e</mi><mi>n</mi><mi>t</mi><mi>i</mi><mi>o</mi><mi>n</mi><mo stretchy="false">(</mo><mi>Q</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>Q</mi></mrow></msub><mo>,</mo><mi>K</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>K</mi></mrow></msub><mo>,</mo><mi>V</mi><msub><mi>W</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>V</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><span class="tex2jax_ignore math-holder">head_i=Attention(QW_{iQ},KW_{iK},VW_{iV})</span></span></span> </p><h3 id="outline_2">为什么要优化attention</h3><p>先看过一下标准的MHA的实现,我们找到hugging face的 transfomer库里面<span><a href="https://zhida.zhihu.com/search?content_id=253548761&amp;content_type=Article&amp;match_order=1&amp;q=distilbert&amp;zhida_source=entity" target="_blank" class="link">distilbert</a></span> 里面的版本，这里我们只抽出来forward函数</p><div><pre class="notranslate hljs language-python" data-highlighted="yes"><span class="hljs-keyword">class</span> <span class="hljs-title class_">MultiHeadSelfAttention</span>(nn.Module):
    .....

    <span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">
        self,
        query: torch.Tensor,
        key: torch.Tensor,
        value: torch.Tensor,
        mask: torch.Tensor,
        head_mask: <span class="hljs-type">Optional</span>[torch.Tensor] = <span class="hljs-literal">None</span>,
        output_attentions: <span class="hljs-built_in">bool</span> = <span class="hljs-literal">False</span>,
    </span>) -&gt; <span class="hljs-type">Tuple</span>[torch.Tensor, ...]:
        <span class="hljs-string">"""
        Parameters:
            query: torch.tensor(bs, seq_length, dim)
            key: torch.tensor(bs, seq_length, dim)
            value: torch.tensor(bs, seq_length, dim)
            mask: torch.tensor(bs, seq_length)

        Returns:
            weights: torch.tensor(bs, n_heads, seq_length, seq_length) Attention weights context: torch.tensor(bs,
            seq_length, dim) Contextualized layer. Optional: only if `output_attentions=True`
        """</span>
        bs, q_length, dim = query.size()
        k_length = key.size(<span class="hljs-number">1</span>)
        <span class="hljs-comment"># assert dim == self.dim, f'Dimensions do not match: {dim} input vs {self.dim} configured'</span>
        <span class="hljs-comment"># assert key.size() == value.size()</span>

        dim_per_head = self.dim // self.n_heads

        mask_reshp = (bs, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>, k_length)

        <span class="hljs-keyword">def</span> <span class="hljs-title function_">shape</span>(<span class="hljs-params">x: torch.Tensor</span>) -&gt; torch.Tensor:
            <span class="hljs-string">"""separate heads"""</span>
            <span class="hljs-keyword">return</span> x.view(bs, -<span class="hljs-number">1</span>, self.n_heads, dim_per_head).transpose(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)

        <span class="hljs-keyword">def</span> <span class="hljs-title function_">unshape</span>(<span class="hljs-params">x: torch.Tensor</span>) -&gt; torch.Tensor:
            <span class="hljs-string">"""group heads"""</span>
            <span class="hljs-keyword">return</span> x.transpose(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>).contiguous().view(bs, -<span class="hljs-number">1</span>, self.n_heads * dim_per_head)

        q = shape(self.q_lin(query))  <span class="hljs-comment"># (bs, n_heads, seq_length, dim_per_head)</span>
        k = shape(self.k_lin(key))  <span class="hljs-comment"># (bs, n_heads, seq_length, dim_per_head)</span>
        v = shape(self.v_lin(value))  <span class="hljs-comment"># (bs, n_heads, seq_length, dim_per_head)</span>

        q = q / math.sqrt(dim_per_head)  <span class="hljs-comment"># (bs, n_heads, seq_length, dim_per_head)</span>
        scores = torch.matmul(q, k.transpose(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>))  <span class="hljs-comment"># (bs, n_heads, seq_length, k_length)</span>


        weights = nn.functional.softmax(scores, dim=-<span class="hljs-number">1</span>)  <span class="hljs-comment"># (bs, n_heads, seq_length, seq_length)</span>
        weights = self.dropout(weights)  <span class="hljs-comment"># (bs, n_heads, seq_length, seq_length)</span>

        <span class="hljs-comment"># Mask heads if we want to</span>
        <span class="hljs-keyword">if</span> head_mask <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>:
            weights = weights * head_mask

        context = torch.matmul(weights, v)  <span class="hljs-comment"># (bs, n_heads, seq_length, dim_per_head)</span>
        context = unshape(context)  <span class="hljs-comment"># (bs, q_length, dim)</span>
        context = self.out_lin(context)  <span class="hljs-comment"># (bs, seq_length, dim)</span>
        <span class="hljs-keyword">return</span> (context,)</pre></div><p>我们逐行来看这个代码，其中忽略mask的内容</p><div><pre class="notranslate hljs language-leaf" data-highlighted="yes">bs, q_length, dim = query.size() <span class="hljs-punctuation">#</span><span class="hljs-params">(<span class="hljs-variable">bs</span>, <span class="hljs-variable">seq_length</span>, <span class="hljs-variable">dim</span>)</span>
k_length = key.size(1)
<span class="hljs-punctuation">#</span> assert dim == self.dim, f'Dimensions do not match: {dim} input vs {self.dim} configured'
<span class="hljs-punctuation">#</span> assert key.size() == value.size()</pre></div><p>第一步，列出来query, key的shape，上面说了如果是self attention，query和key，vaule是同一个tensor。shape记做(bs, seq_length, dim)。bs就是batch size， seq_length就是seq的长度，dim就是embedging size</p><div><pre class="notranslate hljs language-ini" data-highlighted="yes"><span class="hljs-attr">q</span> = shape(self.q_lin(query))  <span class="hljs-comment"># (bs, n_heads, seq_length, dim_per_head)</span>
<span class="hljs-attr">k</span> = shape(self.k_lin(key))  <span class="hljs-comment"># (bs, n_heads, seq_length, dim_per_head)</span>
<span class="hljs-attr">v</span> = shape(self.v_lin(value))  <span class="hljs-comment"># (bs, n_heads, seq_length, dim_per_head)</span></pre></div><p>第二步，self.q_lin就是nn.linear(embeding_size, embeding_size), 这里为了方便，我直接这么算。k_lin, v_lin同样。</p><p>那么 self.q_lin(query)的size就是(bs, embeding_size, dim), 上面提到dim就是embeding_size，那么self.q_lin(query)的shape就是(bs, embeding_size, embeding_size)，同理，self.k_lin(key), self.v_lin(value)之后的形状一致。</p><p>这里他加了一个shape的函数，我们看他做了什么</p><div><pre class="notranslate hljs language-python" data-highlighted="yes"><span class="hljs-keyword">def</span> <span class="hljs-title function_">shape</span>(<span class="hljs-params">x: torch.Tensor</span>) -&gt; torch.Tensor:
    <span class="hljs-string">"""separate heads"""</span>
    <span class="hljs-keyword">return</span> x.view(bs, -<span class="hljs-number">1</span>, self.n_heads, dim_per_head).transpose(<span class="hljs-number">1</span>, <span class="hljs-number">2</span>)</pre></div><p>注释写的很明显他这里就是拆分成多头。注意这里的实现和MHA的公式是不太一样的，MHA的图上是有query, key, value对应和多个矩阵乘得到结果。但是这个代码里面是把所有$$W_{iQ}$$合并起来和query来做矩阵乘法。得到了一个大的matrix后，然后在把得到的Q拆分成$$Q_i$$ 同理，V matrix，K matrix也是这样。因此拆完多头之后的Q，K，V的形状是这样(bs, n_heads, seq_length, dim_per_head)。想象一下，这个QKV是4D的，而不再是3D，多出来的一个维度就是n_heads.<br>再往后就是按照attention的标准算法套公式了，略过不表。最后又来一个unshape。</p><div><pre class="notranslate hljs language-ini" data-highlighted="yes"><span class="hljs-attr">context</span> = torch.matmul(weights, v)  <span class="hljs-comment"># (bs, n_heads, seq_length, dim_per_head)</span>
<span class="hljs-attr">context</span> = unshape(context)  <span class="hljs-comment"># (bs, seq_length, dim)</span></pre></div><p>这里也就是把多个head的attention合并起来，与MHA公式中的Concat对应。<br>这里我们直接用deepseek把这个mha的代码改写一下，让他和pytorch里面的mha函数签名一样，并且导出onnx版本。这样我们就可以看到一个比较干净的MHA的netron视图了。（这里seq_length = 50, embeding_size=256, n_head = 8）,inputshape = (1, 50, 256)</p><p>可以看到这里导出的视图和代码实现几乎完全一致，如果没有想明白可以多看一下。能够看到这里显然有两个现象</p><p><img src="https://pic4.zhimg.com/v2-1b36acbbdce10e9e83cc5b0b2771f8f9_r.jpg" class="large"></p><ul><li>大量的reshape和transpose</li><li>大量的2D的matmul以及3D的matmul</li></ul><p>那么这里的问题就转化为如何优化这两个问题</p><h3 id="outline_3">优化方法</h3><p>这里我参考了MNN，苹果，高通的一些通用的做法加上了一些自己的理解。</p><p>选取更优的shape</p><p>因为这个input是三维的，再回头确认一下MHA的代码 <code>bs, q_length, dim = query.size()</code> ，可以看到query，key，value都是三维的。我们简单一些用（B,S,C）来表示。但是在从前NPU和一些推理框架都是对4D数据（NCHW）进行了高度优化的。因此可以考虑将代码中的输入query，key， value改写一下，对齐到NCHW的结构，我们把输入改成(B,C,1, S). 那为什么要这么改呢，且看第二步。</p><p>线性层优化</p><ul><li>方法一，linear转conv</li></ul><p>这里苹果和高通采用的办法均为把上述代码中的 self.q_lin, self.k_lin, self.v_lin改写为conv。为什么能这么改呢？</p><p>这里涉及到一个基础知识，线性层等于1x1的conv。具体可以看这个写的<a href="https://zhuanlan.zhihu.com/p/492257579" target="_blank"><span>https://</span><span>zhuanlan.zhihu.com/p/49</span><span>2257579</span></a>。这里我们简单理解一下就行了，给出这样一个结论对（B, S ,C）这个tensor做linear，也就是</p><p><span><span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>B</mi><mo>,</mo><mi>S</mi><mo>,</mo><msub><mi>C</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2217;</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>C</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub><mo>,</mo><msub><mi>C</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>B</mi><mo>,</mo><mi>S</mi><mo>,</mo><msub><mi>C</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="37.763ex" height="2.789ex" viewBox="0 -849.8 16259.2 1200.9" role="img" focusable="false" aria-hidden="true" style="vertical-align: -0.815ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use xlink:href="#MJMATHI-42" x="389" y="0"></use><use xlink:href="#MJMAIN-2C" x="1149" y="0"></use><use xlink:href="#MJMATHI-53" x="1594" y="0"></use><use xlink:href="#MJMAIN-2C" x="2239" y="0"></use><g transform="translate(2684,0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use><g transform="translate(715,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="345" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="4169" y="0"></use><use xlink:href="#MJMAIN-2217" x="4780" y="0"></use><use xlink:href="#MJMAIN-28" x="5503" y="0"></use><g transform="translate(5893,0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use><g transform="translate(715,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="345" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="7377" y="0"></use><g transform="translate(7822,0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use><g transform="translate(715,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-75" x="485" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="1058" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="9642" y="0"></use><use xlink:href="#MJMAIN-3D" x="10309" y="0"></use><use xlink:href="#MJMAIN-28" x="11365" y="0"></use><use xlink:href="#MJMATHI-42" x="11755" y="0"></use><use xlink:href="#MJMAIN-2C" x="12514" y="0"></use><use xlink:href="#MJMATHI-53" x="12959" y="0"></use><use xlink:href="#MJMAIN-2C" x="13605" y="0"></use><g transform="translate(14050,0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use><g transform="translate(715,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-75" x="485" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="1058" y="0"></use></g></g><use xlink:href="#MJMAIN-29" x="15869" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>B</mi><mo>,</mo><mi>S</mi><mo>,</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy="false">)</mo><mo>∗</mo><mo stretchy="false">(</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi></mrow></msub><mo>,</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>B</mi><mo>,</mo><mi>S</mi><mo>,</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo stretchy="false">)</mo></math></span></span><span class="tex2jax_ignore math-holder">(B,S,C_{in}) * (C_{in},C_{out}) = (B,S,C_{out})</span></span></span> 类似于一个改变维度的操作，</p><p>同理对于一个4D的tensor做一个1x1卷积的操作，也就是 <span><span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 100%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo stretchy=&quot;false&quot;>(</mo><mi>B</mi><mo>,</mo><msub><mi>C</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub><mo>,</mo><mn>1</mn><mo>,</mo><mi>S</mi><mo stretchy=&quot;false&quot;>)</mo><mo>&amp;#x2217;</mo><mo stretchy=&quot;false&quot;>(</mo><msub><mi>C</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>i</mi><mi>n</mi></mrow></msub><mo>,</mo><msub><mi>C</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy=&quot;false&quot;>)</mo><mo>=</mo><mo stretchy=&quot;false&quot;>(</mo><mi>B</mi><mo>,</mo><msub><mi>C</mi><mrow class=&quot;MJX-TeXAtom-ORD&quot;><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo>,</mo><mn>1</mn><mo>,</mo><mi>S</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="46.549ex" height="2.789ex" viewBox="0 -849.8 20041.8 1200.9" role="img" focusable="false" aria-hidden="true" style="vertical-align: -0.815ex;"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><use xlink:href="#MJMATHI-42" x="389" y="0"></use><use xlink:href="#MJMAIN-2C" x="1149" y="0"></use><g transform="translate(1594,0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use><g transform="translate(715,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="345" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="3078" y="0"></use><use xlink:href="#MJMAIN-31" x="3523" y="0"></use><use xlink:href="#MJMAIN-2C" x="4024" y="0"></use><use xlink:href="#MJMATHI-53" x="4469" y="0"></use><use xlink:href="#MJMAIN-29" x="5114" y="0"></use><use xlink:href="#MJMAIN-2217" x="5726" y="0"></use><use xlink:href="#MJMAIN-28" x="6449" y="0"></use><g transform="translate(6838,0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use><g transform="translate(715,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="345" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="8323" y="0"></use><g transform="translate(8768,0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use><g transform="translate(715,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-75" x="485" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="1058" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="10587" y="0"></use><use xlink:href="#MJMAIN-31" x="11032" y="0"></use><use xlink:href="#MJMAIN-2C" x="11533" y="0"></use><use xlink:href="#MJMAIN-31" x="11978" y="0"></use><use xlink:href="#MJMAIN-29" x="12479" y="0"></use><use xlink:href="#MJMAIN-3D" x="13146" y="0"></use><use xlink:href="#MJMAIN-28" x="14202" y="0"></use><use xlink:href="#MJMATHI-42" x="14592" y="0"></use><use xlink:href="#MJMAIN-2C" x="15351" y="0"></use><g transform="translate(15796,0)"><use xlink:href="#MJMATHI-43" x="0" y="0"></use><g transform="translate(715,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6F" x="0" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-75" x="485" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-74" x="1058" y="0"></use></g></g><use xlink:href="#MJMAIN-2C" x="17615" y="0"></use><use xlink:href="#MJMAIN-31" x="18061" y="0"></use><use xlink:href="#MJMAIN-2C" x="18561" y="0"></use><use xlink:href="#MJMATHI-53" x="19006" y="0"></use><use xlink:href="#MJMAIN-29" x="19652" y="0"></use></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo stretchy="false">(</mo><mi>B</mi><mo>,</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi></mrow></msub><mo>,</mo><mn>1</mn><mo>,</mo><mi>S</mi><mo stretchy="false">)</mo><mo>∗</mo><mo stretchy="false">(</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>i</mi><mi>n</mi></mrow></msub><mo>,</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo>,</mo><mn>1</mn><mo>,</mo><mn>1</mn><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">(</mo><mi>B</mi><mo>,</mo><msub><mi>C</mi><mrow class="MJX-TeXAtom-ORD"><mi>o</mi><mi>u</mi><mi>t</mi></mrow></msub><mo>,</mo><mn>1</mn><mo>,</mo><mi>S</mi><mo stretchy="false">)</mo></math></span></span><span class="tex2jax_ignore math-holder">(B,C_{in}, 1, S)*(C_{in}, C_{out}, 1, 1) = (B, C_{out}, 1, S)</span></span></span> </p><p>这两个操作，初始的tensor是改变了维度，最后的tensor也是改变了维度，这两个操作可以是对等的。</p><p>因此，这在query，key，value上的这几个2D矩阵乘法（B=1，所以直接视为矩阵乘）操作，可以直接转化成卷积。</p><ul><li>方法二，合并成大矩阵</li></ul><p>这里MNN采用的办法是把query，key，value的这几个线性层的操作合并到一个大的矩阵乘，他并没有去做第一步tensor的改变。通过在GPU层进行高度优化的<span><a href="https://zhida.zhihu.com/search?content_id=253548761&amp;content_type=Article&amp;match_order=1&amp;q=GEMM&amp;zhida_source=entity" target="_blank" class="link">GEMM</a></span>，来打满FLOPS。<br>before：</p><p><img src="https://pic1.zhimg.com/v2-279ee0425e6960fdf54884a3615c52fe_r.jpg" class="large"></p><p><br>after：</p><p><img src="https://pic3.zhimg.com/v2-90993d81f3f4af10825d64e1b204eb96_r.jpg" class="large"></p><p><br>因为高通/苹果都是在NPU上的优化，这么优化的一个可能原因是他的conv做的比大矩阵的GEMM优化做的更好，所以他们采用了方法一，而MNN在GPU上做优化，所以他们采用了方法二。</p><h3 id="outline_4">多头转单头</h3><p>这一步是最为关键的一步，也是减少了transpose和reshape的根本原因。<br>这里我们按照苹果和高通的思路往下走，也就是选择了(B,C,1,S)的这种。这里我们直接上代码, 为了方便，我把mask之类的代码全部直接删掉了。</p><div><pre class="notranslate hljs language-python" data-highlighted="yes"><span class="hljs-keyword">def</span> <span class="hljs-title function_">forward</span>(<span class="hljs-params">self,
                query,
                key,
                value,
                mask,
                head_mask=<span class="hljs-literal">None</span>,
                output_attentions=<span class="hljs-literal">False</span></span>):
        <span class="hljs-string">"""
        Parameters:
            query: torch.tensor(bs, dim, 1, seq_length)
            key: torch.tensor(bs, dim, 1, seq_length)
            value: torch.tensor(bs, dim, 1, seq_length)
            mask: torch.tensor(bs, seq_length) or torch.tensor(bs, seq_length, 1, 1)

        Returns:
            weights: torch.tensor(bs, n_heads, seq_length, seq_length) Attention weights context: torch.tensor(bs,
            dim, 1, seq_length) Contextualized layer. Optional: only if `output_attentions=True`
        """</span>
.....

        bs, dim, dummy, seqlen = query.size()

        <span class="hljs-comment"># Project q, k and v</span>
        q = self.q_lin(query)  <span class="hljs-comment">#（b, embeding, 1, seqlen）</span>
        k = self.k_lin(key)    <span class="hljs-comment">#（b, embeding, 1, seqlen）</span>
        v = self.v_lin(value)  <span class="hljs-comment">#（b, embeding, 1, seqlen）</span>
.....
        <span class="hljs-comment"># Compute scaled dot-product attention</span>
        dim_per_head = self.dim // self.n_heads
        mh_q = q.split(
            dim_per_head,
            dim=<span class="hljs-number">1</span>)  <span class="hljs-comment"># (bs, dim_per_head, 1, seqlen) * n_heads</span>
        mh_k = k.transpose(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>).split(
            dim_per_head,
            dim=<span class="hljs-number">3</span>)  <span class="hljs-comment"># (bs, s, 1, dim_per_head) * n_heads</span>
        mh_v = v.split(
            dim_per_head,
            dim=<span class="hljs-number">1</span>)  <span class="hljs-comment"># (bs, dim_per_head, 1, seqlen) * n_heads</span>

        normalize_factor = <span class="hljs-built_in">float</span>(dim_per_head)**-<span class="hljs-number">0.5</span>
        attn_weights = [
            torch.einsum(<span class="hljs-string">'bchq,bkhc-&gt;bkhq'</span>, [qi, ki]) * normalize_factor
            <span class="hljs-keyword">for</span> qi, ki <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(mh_q, mh_k)
        ]  <span class="hljs-comment"># (bs, seqlen, 1, seqlen) * n_heads</span>


        attn_weights = [aw.softmax(dim=<span class="hljs-number">1</span>) <span class="hljs-keyword">for</span> aw <span class="hljs-keyword">in</span> attn_weights
                        ]  <span class="hljs-comment"># (bs, seqlen, 1, seqlen) * n_heads</span>
        attn = [
            torch.einsum(<span class="hljs-string">'bkhq,bchk-&gt;bchq'</span>, wi, vi)
            <span class="hljs-keyword">for</span> wi, vi <span class="hljs-keyword">in</span> <span class="hljs-built_in">zip</span>(attn_weights, mh_v)
        ]  <span class="hljs-comment"># (bs, dim_per_head, 1, seqlen) * n_heads</span>

        attn = torch.cat(attn, dim=<span class="hljs-number">1</span>)  <span class="hljs-comment"># (bs, dim, 1, seqlen)</span>

        attn = self.out_lin(attn)
        <span class="hljs-keyword">return</span> (attn, )</pre></div><p>这里我们再次挑一些关键代码来分析一下</p><div><pre class="notranslate hljs language-ini" data-highlighted="yes"><span class="hljs-comment"># Project q, k and v</span>
<span class="hljs-attr">q</span> = self.q_lin(query)  <span class="hljs-comment">#（b, embeding_size, 1, seqlen）</span>
<span class="hljs-attr">k</span> = self.k_lin(key)    <span class="hljs-comment">#（b, embeding_size, 1, seqlen）</span>
<span class="hljs-attr">v</span> = self.v_lin(value)  <span class="hljs-comment">#（b, embeding_size, 1, seqlen）</span></pre></div><p>这里的self.q_lin，self.k_lin，self.v_lin就已经替换成了conv，conv的shape是(embeding_size, embeding_size,1,1)，因此得到q,k,v的shape均是(b, embeding_size, 1, seqlen),<br>相比于上文拆分多头的def shape的那个函数，这里使用tensor内置的split函数来拆分</p><div><pre class="notranslate hljs language-mipsasm" data-highlighted="yes">mh_q = q.split(
    <span class="hljs-keyword">dim_per_head,
</span>    <span class="hljs-keyword">dim=1) </span> <span class="hljs-comment"># (bs, dim_per_head, 1, seqlen) * n_heads</span>
mh_k = k.transpose(<span class="hljs-number">1</span>, <span class="hljs-number">3</span>).split(
    <span class="hljs-keyword">dim_per_head,
</span>    <span class="hljs-keyword">dim=3) </span> <span class="hljs-comment"># (bs, seqlen, 1, dim_per_head) * n_heads</span>
mh_v = v.split(
    <span class="hljs-keyword">dim_per_head,
</span>    <span class="hljs-keyword">dim=1) </span> <span class="hljs-comment"># (bs, dim_per_head, 1, seqlen) * n_heads</span></pre></div><p>这里把多头拆出来作为一个显示的维度，即mh_q是一个list，list的长度是n_heads, 而每一个tensor的长度是(bs, dim_per_head, 1, seqlen)，这里注意k已经做了转置。然后，我们对拆下来的每一个h_q, h_k做einsum</p><div><pre class="notranslate hljs language-ini" data-highlighted="yes"><span class="hljs-attr">attn_weights</span> = [
    torch.einsum(<span class="hljs-string">'bchq,bkhc-&gt;bkhq'</span>, [qi, ki]) * normalize_factor
    for qi, ki in zip(mh_q, mh_k)
]  <span class="hljs-comment"># (bs, seqlen, 1, seqlen) * n_heads</span></pre></div><p>einsum的表示的意思就是两个矩阵分别表示为(bchq), (bkhc) 在c这个维度上做求和，最终得出来（bkhq）,按照苹果的文档表述，这个操作可以减少非常多的内存操作。</p><p>获得n_head个 attention_matrix后，再继续和v做einsum。</p><p>做了以上这些事情之后，我们看一下最终的网络结构图</p><p><img src="https://pic1.zhimg.com/v2-8691f60ade756303cb34c7591199cf3c_r.jpg" class="large"></p><p>这里我们能看到之类显示的变成了8个head来进行计算，同时，所有的线性层都变成了conv。</p><p>至于为什么要把多头转化成单头来做scale_dot_product_attention.我觉的除了内存上的操作以外，额外原因在于多头的矩阵乘法，回到优化前的代码</p><div><pre class="notranslate hljs language-ini" data-highlighted="yes"><span class="hljs-attr">scores</span> = torch.matmul(q, k.transpose(<span class="hljs-number">2</span>, <span class="hljs-number">3</span>))  <span class="hljs-comment"># (bs, n_heads, seq_length, k_length)</span></pre></div><p>我们看到这里q,k做的矩阵乘法均为3d的matmul，可能这里会有人有疑惑，高维度的矩阵乘和二维矩阵乘有什么区别。</p><p>高维的矩阵乘，需要最后A，B两个tensor最后两个维度的shape能够对应上，即(M X N) *(N X K), 前面的所有维度的所有乘积看作batch次，因此有batch次的2d 矩阵乘法。所以还并不能直接转化到2维的矩阵乘法，因此在实现上会造成cache的利用率等比较低。所以比较低效。拆开之后，q,k,v的matmul均可以转化成标准的二维矩阵乘法。所以在执行的效率上有了很大的提升。</p><p>同样，我们看MNN的实现，他也是把MHA给split开，做batchMatmul. 这里我没有去看具体的实现，感觉上思路和苹果/高通的拆多头是一致的。</p><p><img src="https://pic3.zhimg.com/v2-cb592e2c11887364cd363031b5abcec4_r.jpg" class="large"></p><h3 id="outline_5">总结</h3><p><br>本文是自己在学习端侧transormer部署的过程中一点点心得。希望抛砖引玉。</p><h3 id="outline_6">参考资料</h3><p><br><a href="https://link.zhihu.com/?target=https%3A//machinelearning.apple.com/research/neural-engine-transformers" target="_blank" rel="nofollow noreferrer" class="link">Deploying Transformers on the Apple Neural Engine</a></p><p><a href="https://zhuanlan.zhihu.com/p/721798565" target="_blank" class="link">Diffusion大模型: 用你的手机/电脑运行文生图方案</a><br>高通的资料是一个pdf，暂时还不知道来源，就先不放了。可以理解为和苹果的一致</p><div class="footer"><div class="ant-space css-16cpc8y ant-space-horizontal ant-space-align-center" style="flex-wrap: wrap;"><div class="ant-space-item"><span class="ant-tag css-16cpc8y">MNN</span></div><div class="ant-space-item"><span class="ant-tag css-16cpc8y">Transformer</span></div><div class="ant-space-item"><span class="ant-tag css-16cpc8y">深度学习（Deep Learning）</span></div></div></div><p style="text-align:center;margin-top:100px;">由 <a href="https://circlereader.com" target="_blank">Circle 阅读助手</a> 生成</p></div></div></div></div></body></html>